import{a as bt,b as B,c as ht,d as xt,e as _t,f as yt}from"./chunk-V2RQKADX.js";import{$ as Be,$a as Me,$b as pe,Ba as He,Bb as at,Cb as me,D as ne,Da as ae,Db as st,E as a,Ea as E,Eb as W,Fa as M,Fb as R,Gb as dt,H as p,Ha as G,Hb as ct,I as O,Ib as lt,J as oe,Ka as se,L as v,La as z,Ma as de,P as l,Q as o,R as s,S as g,Sa as ce,Tb as Y,V as I,Vb as ut,W as y,Wa as We,Wb as K,X as u,Xa as T,Xb as N,Ya as Ye,Yb as mt,Za as k,Zb as pt,_b as gt,ac as vt,ba as je,bb as le,bc as ft,ca as qe,cb as q,d as De,da as c,db as ue,ea as _,eb as Ke,fa as x,g as Oe,ga as P,gb as Je,ib as Xe,j as F,ja as Le,jb as Ze,k as Fe,ka as Qe,kb as et,l as Ve,la as Ue,lb as tt,m as $e,mb as rt,n as Re,oa as Ge,ob as it,p as Ne,pa as Q,q as Z,qa as $,s as L,sa as ze,t as ie,tb as nt,u as V,va as f,vb as H,w as C,wa as b,x as S,xb as ot,ya as U,yb as A,zb as w}from"./chunk-CRG46VMK.js";var At=i=>({dark:i}),wt=(i,t,e,r)=>({"right-[17rem]":i,"right-4":t,"left-[17rem]":e,"left-4":r}),Et=(i,t)=>({"lg:mr-64":i,"lg:ml-64":t}),Tt=i=>({"flex-row-reverse":i}),kt=(i,t)=>({"mr-4":i,"ml-4":t});function Dt(i,t){if(i&1){let e=I();o(0,"div",9),y("click",function(){C(e);let n=u();return S(n.closeSidebar())}),s()}}var ge=class i{constructor(t,e,r,n,d,m,h){this.themeService=t;this.authService=e;this.router=r;this.languageService=n;this.cartService=d;this.route=m;this.sidebarConfigService=h}isDarkMode=!1;sidebarOpen=!1;sidebarConfig;isRTL=!0;orderTypeId=2;ngOnInit(){this.themeService.isDarkMode$.subscribe(e=>{this.isDarkMode=e}),this.route.params.subscribe(e=>{this.orderTypeId=+e.orderTypeId||2}),this.router.events.pipe(Fe(e=>e instanceof We)).subscribe(e=>{let r=e.urlAfterRedirects.match(/\/order\/(\d+)/);r&&(this.orderTypeId=+r[1])}),this.isRTL=this.languageService.currentLang==="ar",window.innerWidth>=1024&&(this.sidebarOpen=!0),new MutationObserver(()=>{this.isRTL=document.documentElement.getAttribute("dir")==="rtl"}).observe(document.documentElement,{attributes:!0,attributeFilter:["dir"]}),this.sidebarConfig=this.sidebarConfigService.getOrderConfig()}toggleSidebar(){this.sidebarOpen=!this.sidebarOpen}closeSidebar(){this.sidebarOpen=!1}static \u0275fac=function(e){return new(e||i)(p(ft),p(w),p(k),p(W),p(K),p(T),p(bt))};static \u0275cmp=O({type:i,selectors:[["app-order"]],standalone:!1,decls:12,vars:26,consts:[[1,"min-h-screen","flex","bg-gray-50",3,"dir","ngClass"],[3,"sidebarOpenChange","config","sidebarOpen"],["class","fixed inset-0 bg-black bg-opacity-50 z-40 lg:hidden transition-opacity duration-300 backdrop-blur-sm",3,"click",4,"ngIf"],[1,"fixed","top-4","z-50","lg:hidden","p-3","rounded-xl","bg-white","shadow-lg","hover:shadow-xl","transition-all","duration-300","border-2","border-gray-200","hover:border-blue-400","text-gray-700","hover:text-blue-600",3,"click","ngClass"],[1,"flex-1","flex","flex-col","min-w-0",3,"ngClass"],[1,"sticky","top-0","z-30","bg-white","border-b","border-gray-200","shadow-sm","backdrop-blur-sm","bg-opacity-95"],[1,"flex","items-center","justify-between","h-16","px-4","sm:px-6","lg:px-8",3,"ngClass"],[1,"flex-1",3,"ngClass"],[1,"flex-1","overflow-y-auto","bg-gray-50","p-4","sm:p-6","lg:p-8"],[1,"fixed","inset-0","bg-black","bg-opacity-50","z-40","lg:hidden","transition-opacity","duration-300","backdrop-blur-sm",3,"click"]],template:function(e,r){e&1&&(o(0,"div",0)(1,"app-sidebar",1),Ue("sidebarOpenChange",function(d){return Qe(r.sidebarOpen,d)||(r.sidebarOpen=d),d}),s(),v(2,Dt,1,0,"div",2),o(3,"button",3),y("click",function(){return r.toggleSidebar()}),g(4,"i"),s(),o(5,"div",4)(6,"header",5)(7,"div",6)(8,"div",7),g(9,"app-breadcrumb"),s()()(),o(10,"main",8),g(11,"router-outlet"),s()()()),e&2&&(l("dir",r.isRTL?"rtl":"ltr")("ngClass",Q(11,At,r.isDarkMode)),a(),l("config",r.sidebarConfig),Le("sidebarOpen",r.sidebarOpen),a(),l("ngIf",r.sidebarOpen),a(),l("ngClass",ze(13,wt,r.isRTL&&r.sidebarOpen,r.isRTL&&!r.sidebarOpen,!r.isRTL&&r.sidebarOpen,!r.isRTL&&!r.sidebarOpen)),a(),qe(r.sidebarOpen?"bi bi-x-lg text-xl":"bi bi-list text-xl"),a(),l("ngClass",$(18,Et,r.isRTL,!r.isRTL)),a(2),l("ngClass",Q(21,Tt,r.isRTL)),a(),l("ngClass",$(23,kt,r.isRTL,!r.isRTL)))},dependencies:[ae,M,Ye,R,ht,xt],styles:['aside[_ngcontent-%COMP%]::-webkit-scrollbar{width:6px}aside[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:transparent}aside[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#cbd5e1;border-radius:3px}aside[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#94a3b8}.dark[_ngcontent-%COMP%]   aside[_ngcontent-%COMP%]{background:linear-gradient(to bottom,#1f2937,#111827);border-color:#374151}.dark[_ngcontent-%COMP%]   aside[_ngcontent-%COMP%]   nav[_ngcontent-%COMP%]   .text-gray-700[_ngcontent-%COMP%]{color:#d1d5db}.dark[_ngcontent-%COMP%]   aside[_ngcontent-%COMP%]   nav[_ngcontent-%COMP%]   .hover\\\\[_ngcontent-%COMP%]:bg-gray-100:hover{background-color:#374151;color:#f9fafb}.dark[_ngcontent-%COMP%]   header[_ngcontent-%COMP%]{background-color:#1f2937f2;border-color:#374151;color:#f9fafb}.dark[_ngcontent-%COMP%]   main[_ngcontent-%COMP%]{background-color:#111827}@media (max-width: 1023px){aside[_ngcontent-%COMP%]{box-shadow:-2px 0 8px #0000001a}[dir=ltr][_ngcontent-%COMP%]   aside[_ngcontent-%COMP%]{box-shadow:2px 0 8px #0000001a}}.transform[_ngcontent-%COMP%]{transition:transform .3s ease-in-out}nav[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], nav[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{position:relative}nav[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:before, nav[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:before{content:"";position:absolute;top:50%;left:50%;width:0;height:0;border-radius:50%;background:#10b9814d;transform:translate(-50%,-50%);transition:width .6s,height .6s}nav[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:active:before, nav[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:active:before{width:300px;height:300px}.bg-gradient-to-r.from-emerald-500.to-teal-600[_ngcontent-%COMP%]:after{content:"";position:absolute;top:0;bottom:0;width:3px;background:linear-gradient(to bottom,#10b981,#14b8a6);border-radius:0 4px 4px 0}[dir=ltr][_ngcontent-%COMP%]   .bg-gradient-to-r.from-emerald-500.to-teal-600[_ngcontent-%COMP%]:after{left:0;right:auto;border-radius:4px 0 0 4px}[dir=rtl][_ngcontent-%COMP%]   .bg-gradient-to-r.from-emerald-500.to-teal-600[_ngcontent-%COMP%]:after{right:0;left:auto}h3.text-xs[_ngcontent-%COMP%]{letter-spacing:.1em;text-shadow:0 1px 2px rgba(0,0,0,.05)}.w-8.h-8.rounded-lg[_ngcontent-%COMP%]{transition:all .3s cubic-bezier(.4,0,.2,1)}.w-8.h-8.rounded-lg[_ngcontent-%COMP%]:hover{transform:scale(1.1)}.bg-gradient-to-r.from-emerald-500.to-teal-600[_ngcontent-%COMP%]{background:linear-gradient(135deg,#10b981,#14b8a6);box-shadow:0 4px 14px #10b98163}.bg-gradient-to-r.from-emerald-500.to-teal-600[_ngcontent-%COMP%]:hover{box-shadow:0 6px 20px #10b98173}.bg-gradient-to-r.from-emerald-600.via-teal-600.to-cyan-600[_ngcontent-%COMP%]{background:linear-gradient(135deg,#059669,#0d9488,#0891b2);box-shadow:0 4px 6px -1px #0000001a,0 2px 4px -1px #0000000f}.w-10.h-10.bg-gradient-to-br.from-emerald-500.to-teal-600[_ngcontent-%COMP%]{box-shadow:0 4px 6px -1px #10b9814d;transition:transform .3s ease}.w-10.h-10.bg-gradient-to-br.from-emerald-500.to-teal-600[_ngcontent-%COMP%]:hover{transform:scale(1.05)}@media (max-width: 640px){aside[_ngcontent-%COMP%]{width:100%;max-width:280px}}']})};var j=class i{constructor(t,e,r){this.breadcrumbService=t;this.translate=e;this.authService=r}getHomeRoute(t){return this.authService.isAdmin?"/admin/main":t?`/order/${t}/categories`:"/order/2/categories"}setOrderCategoriesBreadcrumbs(t){let e=this.getOrderTypeName(t);this.breadcrumbService.setFrom([{label:this.translate.instant("BREADCRUMB.HOME"),route:this.getHomeRoute(t)},{label:e,route:`/order/${t}/categories`},{label:this.translate.instant("BREADCRUMB.CATEGORIES"),route:null}])}setOrderSubCategoriesBreadcrumbs(t,e,r){let n=this.getOrderTypeName(t);this.breadcrumbService.setFrom([{label:"\u0627\u0644\u0631\u0626\u064A\u0633\u064A\u0629",route:this.getHomeRoute(t)},{label:n,route:`/order/${t}/categories`},{label:"\u0627\u0644\u062A\u0635\u0646\u064A\u0641\u0627\u062A",route:`/order/${t}/categories`},{label:r,route:`/order/${t}/categories/${e}/sub-categories`},{label:"\u0627\u0644\u062A\u0635\u0646\u064A\u0641\u0627\u062A \u0627\u0644\u0641\u0631\u0639\u064A\u0629",route:null}])}setOrderProductsBreadcrumbs(t,e,r,n,d){let m=this.getOrderTypeName(t);this.breadcrumbService.setFrom([{label:"\u0627\u0644\u0631\u0626\u064A\u0633\u064A\u0629",route:this.getHomeRoute(t)},{label:m,route:`/order/${t}/categories`},{label:"\u0627\u0644\u062A\u0635\u0646\u064A\u0641\u0627\u062A",route:`/order/${t}/categories`},{label:r,route:`/order/${t}/categories/${e}/sub-categories`},{label:d,route:`/order/${t}/categories/${e}/sub-categories/${n}/products`},{label:"\u0627\u0644\u0645\u0646\u062A\u062C\u0627\u062A",route:null}])}setProductDetailBreadcrumbs(t,e,r,n,d,m){let h=this.getOrderTypeName(t);this.breadcrumbService.setFrom([{label:"\u0627\u0644\u0631\u0626\u064A\u0633\u064A\u0629",route:this.getHomeRoute(t)},{label:h,route:`/order/${t}/categories`},{label:"\u0627\u0644\u062A\u0635\u0646\u064A\u0641\u0627\u062A",route:`/order/${t}/categories`},{label:r,route:`/order/${t}/categories/${e}/sub-categories`},{label:d,route:`/order/${t}/categories/${e}/sub-categories/${n}/products`},{label:m,route:null}])}setCartBreadcrumbs(t){let e=this.getOrderTypeName(t);this.breadcrumbService.setFrom([{label:"\u0627\u0644\u0631\u0626\u064A\u0633\u064A\u0629",route:this.getHomeRoute(t)},{label:e,route:`/order/${t}/categories`},{label:"\u0627\u0644\u0633\u0644\u0629",route:null}])}setOrderSummaryBreadcrumbs(t){let e=this.getOrderTypeName(t);this.breadcrumbService.setFrom([{label:"\u0627\u0644\u0631\u0626\u064A\u0633\u064A\u0629",route:this.getHomeRoute(t)},{label:e,route:`/order/${t}/categories`},{label:"\u0645\u0644\u062E\u0635 \u0627\u0644\u0637\u0644\u0628",route:null}])}getOrderTypeName(t){switch(t){case 1:return"\u0637\u0644\u0628\u0627\u062A \u0627\u0644\u0634\u0631\u0627\u0621";case 2:return"\u0637\u0644\u0628\u0627\u062A \u0627\u0644\u0628\u064A\u0639";default:return"\u0627\u0644\u0637\u0644\u0628\u0627\u062A"}}setPendingOrdersBreadcrumbs(t){this.breadcrumbService.setFrom([{label:this.translate.instant("BREADCRUMB.HOME"),route:this.getHomeRoute(t)},{label:this.translate.instant("BREADCRUMB.PENDING_ORDERS"),route:null}])}static \u0275fac=function(e){return new(e||i)(V(B),V(at),V(w))};static \u0275prov=L({token:i,factory:i.\u0275fac,providedIn:"root"})};var Ft=(i,t)=>({"left-4":i,"right-4":t}),Ot=i=>({"flex-row-reverse":i}),Vt=(i,t)=>({"right-4":i,"left-4":t}),$t=(i,t)=>({"text-right":i,"text-left":t}),Rt=(i,t)=>({"items-end text-right":i,"items-start text-left":t});function Nt(i,t){if(i&1){let e=I();o(0,"button",20),y("click",function(){C(e);let n=u();return S(n.clearSearch())}),g(1,"i",21),s()}if(i&2){let e=u();l("ngClass",$(1,Vt,e.lang.currentLang!=="ar",e.lang.currentLang==="ar"))}}function Bt(i,t){if(i&1&&(o(0,"span",22),c(1),s()),i&2){let e=u();a(),x(" ",e.lang.currentLang==="ar"?"\u062C\u0627\u0631\u064A \u0627\u0644\u0628\u062D\u062B...":"Searching..."," ")}}function jt(i,t){if(i&1&&(o(0,"span",23),c(1),s()),i&2){let e=u();a(),x(" ",e.lang.currentLang==="ar"?"\u0644\u0627 \u062A\u0648\u062C\u062F \u0646\u062A\u0627\u0626\u062C \u0645\u0637\u0627\u0628\u0642\u0629":"No matching products found"," ")}}function qt(i,t){if(i&1&&(o(0,"span",24),c(1),s()),i&2){let e=u();a(),x(" ",e.searchError," ")}}function Lt(i,t){if(i&1&&(o(0,"span",35),c(1),s()),i&2){let e=u().$implicit,r=u(2);a(),P(" ",r.lang.currentLang==="ar"?"\u0643\u0648\u062F \u0627\u0644\u0645\u0646\u062A\u062C:":"Product Code:"," ",e.code," ")}}function Qt(i,t){if(i&1){let e=I();o(0,"li")(1,"button",29),y("click",function(){let n=C(e).$implicit,d=u(2);return S(d.onSelectProduct(n))}),o(2,"span",30),c(3),s(),o(4,"span",31),g(5,"i",32),o(6,"span"),c(7),o(8,"span",33),c(9,"\u203A"),s(),c(10),s()(),v(11,Lt,2,2,"span",34),s()()}if(i&2){let e=t.$implicit,r=u(2);a(),l("ngClass",$(6,Rt,r.lang.currentLang==="ar",r.lang.currentLang!=="ar")),a(2),x(" ",e.nameAr||e.nameEn," "),a(),l("ngClass",Q(9,Ot,r.lang.currentLang==="ar")),a(3),x(" ",(e.subCategory==null||e.subCategory.category==null?null:e.subCategory.category.nameAr)||(e.subCategory==null||e.subCategory.category==null?null:e.subCategory.category.nameEn)||(r.lang.currentLang==="ar"?"\u062A\u0635\u0646\u064A\u0641 \u063A\u064A\u0631 \u0645\u062D\u062F\u062F":"Uncategorized")," "),a(3),x(" ",(e.subCategory==null?null:e.subCategory.nameAr)||(e.subCategory==null?null:e.subCategory.nameEn)||(r.lang.currentLang==="ar"?"\u0641\u0631\u0639 \u063A\u064A\u0631 \u0645\u062D\u062F\u062F":"Subcategory not set")," "),a(),l("ngIf",e.code)}}function Ut(i,t){if(i&1&&(o(0,"div",25)(1,"div",26),c(2),s(),o(3,"ul",27),v(4,Qt,12,11,"li",28),s()()),i&2){let e=u();a(),l("ngClass",$(3,$t,e.lang.currentLang==="ar",e.lang.currentLang!=="ar")),a(),x(" ",e.lang.currentLang==="ar"?"\u0646\u062A\u0627\u0626\u062C \u0627\u0644\u0628\u062D\u062B":"Search Results"," "),a(2),l("ngForOf",e.searchResults)}}function Gt(i,t){if(i&1&&g(0,"img",47),i&2){let e=u().$implicit,r=u(2);l("src",r.imageUrlService.getImageUrl(e.imagePath,r.serverUrl),ne)("alt",e.nameAr)}}function zt(i,t){i&1&&(o(0,"div",48),g(1,"i",49),s())}function Ht(i,t){if(i&1&&(o(0,"p",50),c(1),f(2,"slice"),s()),i&2){let e=u().$implicit;a(),P(" ",U(2,2,e.description,0,30),"",e.description&&e.description.length>30?"...":""," ")}}function Wt(i,t){if(i&1){let e=I();o(0,"div",38)(1,"div",39),y("click",function(){let n=C(e).$implicit,d=u(2);return S(d.onCardClick(n.id))}),o(2,"div",40),v(3,Gt,1,2,"img",41)(4,zt,2,0,"div",42),s(),o(5,"div",43)(6,"h3",44),c(7),s(),o(8,"div",45),v(9,Ht,3,6,"p",46),s()()()()}if(i&2){let e=t.$implicit;a(3),l("ngIf",e.imagePath),a(),l("ngIf",!e.imagePath),a(3),x(" ",e.nameAr," "),a(2),l("ngIf",e.description)}}function Yt(i,t){if(i&1&&(o(0,"div",36),v(1,Wt,10,4,"div",37),s()),i&2){let e=t.ngIf;a(),l("ngForOf",e)}}function Kt(i,t){i&1&&(o(0,"div",51)(1,"div",52),g(2,"i",53),s(),o(3,"h3",54),c(4,"\u0644\u0627 \u062A\u0648\u062C\u062F \u062A\u0635\u0646\u064A\u0641\u0627\u062A"),s(),o(5,"p",23),c(6,"\u0644\u0645 \u064A\u062A\u0645 \u0627\u0644\u0639\u062B\u0648\u0631 \u0639\u0644\u0649 \u0623\u064A \u062A\u0635\u0646\u064A\u0641\u0627\u062A \u0645\u062A\u0627\u062D\u0629"),s()())}var fe=class i{constructor(t,e,r,n,d,m,h,J,X){this.categoriesService=t;this.lang=e;this.router=r;this.route=n;this.breadcrumbService=d;this.orderBreadcrumbService=m;this.authService=h;this.productsService=J;this.imageUrlService=X}ngOnDestroy(){this.searchSubscription?.unsubscribe()}ngOnInit(){this.route.parent?.paramMap.subscribe(t=>{let e=t.get("orderTypeId");this.orderTypeId=e!==null?Number(e):1,this.orderBreadcrumbService.setOrderCategoriesBreadcrumbs(this.orderTypeId),this.loadCategories()}),this.initializeProductSearch()}categories$;orderTypeId=1;serverUrl=A.resourcesUrl;searchControl=new Je("",{nonNullable:!0});searchResults=[];searchLoading=!1;searchError=null;searchSubscription;loadCategories(){this.categories$=this.categoriesService.GetActiveCategories().pipe(F(t=>t.filter(e=>this.authService.hasCategory(e.id))))}onCardClick(t){this.router.navigate(["/order",this.orderTypeId,"categories",t,"sub-categories"])}clearSearch(){this.searchControl.setValue("",{emitEvent:!0}),this.searchResults=[],this.searchError=null,this.searchLoading=!1}onSelectProduct(t){t?.id&&(this.router.navigate(["/order",this.orderTypeId,"product",t.id],{queryParams:{categoryId:t.subCategory?.categoryId??void 0,subCategoryId:t.subCategoryId??void 0}}),this.searchResults=[],this.searchError=null,this.searchControl.setValue("",{emitEvent:!1}))}initializeProductSearch(){this.searchSubscription=this.searchControl.valueChanges.pipe(F(t=>t?.trim()??""),Z(t=>{t||(this.searchResults=[],this.searchError=null)}),$e(300),Re(),Ne(t=>t?(this.searchLoading=!0,this.searchError=null,this.productsService.SearchProducts(t).pipe(F(e=>e.filter(r=>this.authService.hasProduct(r.id))),Z(()=>this.searchLoading=!1),Ve(e=>(this.searchLoading=!1,this.searchError="\u062D\u062F\u062B \u062E\u0637\u0623 \u0623\u062B\u0646\u0627\u0621 \u0627\u0644\u0628\u062D\u062B \u0639\u0646 \u0627\u0644\u0645\u0646\u062A\u062C\u0627\u062A. \u062D\u0627\u0648\u0644 \u0645\u0631\u0629 \u0623\u062E\u0631\u0649.",Oe([]))))):(this.searchLoading=!1,Oe([])))).subscribe(t=>{this.searchResults=t.slice(0,10)})}static \u0275fac=function(e){return new(e||i)(p(_t),p(W),p(k),p(T),p(B),p(j),p(w),p(Y),p(N))};static \u0275cmp=O({type:i,selectors:[["app-order-categories"]],standalone:!1,decls:27,vars:24,consts:[[1,"min-h-screen","bg-gray-50","py-8"],[1,"max-w-7xl","mx-auto","px-4","sm:px-6","lg:px-8"],[1,"text-center","mb-6","sm:mb-8","px-4"],[1,"text-xl","sm:text-2xl","lg:text-3xl","font-bold","text-gray-900","mb-2","sm:mb-4"],[1,"text-sm","sm:text-base","lg:text-lg","text-gray-600"],[1,"max-w-3xl","mx-auto","mb-8","sm:mb-10","px-4"],[1,"relative"],[1,"pointer-events-none","absolute","inset-y-0","flex","items-center","text-gray-400",3,"ngClass"],[1,"bi","bi-search","text-lg"],["type","search",1,"w-full","rounded-2xl","border","border-gray-200","bg-white","py-3","pl-12","pr-12","shadow-sm","focus:outline-none","focus:ring-2","focus:ring-blue-500","text-sm","sm:text-base",3,"formControl","dir","placeholder"],["type","button","class","absolute inset-y-0 flex items-center text-gray-400 hover:text-gray-600 transition-colors","aria-label","Clear search",3,"ngClass","click",4,"ngIf"],[1,"mt-3","text-sm","text-blue-500","flex","items-center","gap-2","justify-center","sm:justify-between",3,"ngClass"],[1,"hidden","sm:flex","items-center","gap-2"],[1,"bi","bi-lightbulb"],["class","text-blue-600",4,"ngIf"],["class","text-gray-500",4,"ngIf"],["class","text-red-600",4,"ngIf"],["class","mt-4 bg-white rounded-2xl border border-gray-100 shadow-lg overflow-hidden",4,"ngIf"],["class","grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6 xl:grid-cols-8 gap-3 sm:gap-4 lg:gap-6 px-4",4,"ngIf"],["class","text-center py-12",4,"ngIf"],["type","button","aria-label","Clear search",1,"absolute","inset-y-0","flex","items-center","text-gray-400","hover:text-gray-600","transition-colors",3,"click","ngClass"],[1,"bi","bi-x-circle-fill","text-lg"],[1,"text-blue-600"],[1,"text-gray-500"],[1,"text-red-600"],[1,"mt-4","bg-white","rounded-2xl","border","border-gray-100","shadow-lg","overflow-hidden"],[1,"px-5","py-3","border-b","border-gray-100","bg-gray-50","font-semibold","text-gray-700",3,"ngClass"],[1,"max-h-80","overflow-y-auto","divide-y","divide-gray-100"],[4,"ngFor","ngForOf"],["type","button",1,"w-full","px-5","py-4","transition-all","duration-200","hover:bg-blue-50","focus:bg-blue-100","focus:outline-none","flex","flex-col","gap-1",3,"click","ngClass"],[1,"text-sm","sm:text-base","font-semibold","text-gray-900"],[1,"text-xs","sm:text-sm","text-gray-500","flex","items-center","gap-1",3,"ngClass"],[1,"bi","bi-arrow-right-circle"],[1,"mx-1","text-gray-400"],["class","text-xs text-gray-400",4,"ngIf"],[1,"text-xs","text-gray-400"],[1,"grid","grid-cols-2","sm:grid-cols-3","md:grid-cols-4","lg:grid-cols-6","xl:grid-cols-8","gap-3","sm:gap-4","lg:gap-6","px-4"],["class","group h-full",4,"ngFor","ngForOf"],[1,"group","h-full"],[1,"bg-white","rounded-2xl","shadow-lg","hover:shadow-xl","transition-all","duration-300","transform","hover:scale-105","cursor-pointer","overflow-hidden","border","border-gray-100","h-full","flex","flex-col",3,"click"],[1,"aspect-square","bg-gradient-to-br","from-blue-50","to-indigo-100","flex","items-center","justify-center","p-6","flex-shrink-0"],["class","w-full h-full object-cover rounded-xl",3,"src","alt",4,"ngIf"],["class","w-16 h-16 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-2xl flex items-center justify-center",4,"ngIf"],[1,"p-2","sm:p-3","lg:p-4","text-center","flex","flex-col","flex-grow"],[1,"font-bold","text-gray-900","text-xs","sm:text-sm","mb-1","group-hover:text-blue-600","transition-colors"],[1,"flex-grow","flex","items-center","justify-center"],["class","text-gray-500 text-xs leading-relaxed",4,"ngIf"],[1,"w-full","h-full","object-cover","rounded-xl",3,"src","alt"],[1,"w-16","h-16","bg-gradient-to-br","from-blue-500","to-indigo-600","rounded-2xl","flex","items-center","justify-center"],[1,"bi","bi-grid-3x3-gap","text-white","text-2xl"],[1,"text-gray-500","text-xs","leading-relaxed"],[1,"text-center","py-12"],[1,"w-24","h-24","bg-gray-100","rounded-full","flex","items-center","justify-center","mx-auto","mb-4"],[1,"bi","bi-grid-3x3-gap","text-gray-400","text-3xl"],[1,"text-lg","font-semibold","text-gray-900","mb-2"]],template:function(e,r){if(e&1&&(o(0,"div",0)(1,"div",1)(2,"div",2)(3,"h1",3),c(4),s(),o(5,"p",4),c(6),s()(),o(7,"div",5)(8,"div",6)(9,"span",7),g(10,"i",8),s(),g(11,"input",9),v(12,Nt,2,4,"button",10),s(),o(13,"div",11)(14,"div",12),g(15,"i",13),o(16,"span"),c(17),s()(),o(18,"div"),v(19,Bt,2,1,"span",14)(20,jt,2,1,"span",15)(21,qt,2,1,"span",16),s()(),v(22,Ut,5,6,"div",17),s(),v(23,Yt,2,1,"div",18),f(24,"async"),v(25,Kt,7,0,"div",19),f(26,"async"),s()()),e&2){let n;a(4),x(" ",r.lang.currentLang==="ar"?"\u0627\u062E\u062A\u0631 \u0627\u0644\u062A\u0635\u0646\u064A\u0641":"Select a Category"," "),a(2),x(" ",r.lang.currentLang==="ar"?"\u064A\u0645\u0643\u0646\u0643 \u0627\u0644\u0628\u062D\u062B \u0645\u0628\u0627\u0634\u0631\u0629 \u0639\u0646 \u0627\u0644\u0645\u0646\u062A\u062C \u0623\u0648 \u062A\u0635\u0641\u062D \u0627\u0644\u062A\u0635\u0646\u064A\u0641\u0627\u062A":"Search directly for a product or browse the categories"," "),a(3),l("ngClass",$(19,Ft,r.lang.currentLang!=="ar",r.lang.currentLang==="ar")),a(2),l("formControl",r.searchControl)("dir",r.lang.currentLang==="ar"?"rtl":"ltr")("placeholder",r.lang.currentLang==="ar"?"\u0627\u0628\u062D\u062B \u0639\u0646 \u0645\u0646\u062A\u062C \u0628\u0627\u0644\u0627\u0633\u0645 \u0623\u0648 \u0627\u0644\u0643\u0648\u062F...":"Search for a product by name or code..."),a(),l("ngIf",r.searchControl.value),a(),l("ngClass",Q(22,Ot,r.lang.currentLang==="ar")),a(4),x(" ",r.lang.currentLang==="ar"?"\u064A\u0645\u0643\u0646\u0643 \u0643\u062A\u0627\u0628\u0629 \u062C\u0632\u0621 \u0645\u0646 \u0627\u0644\u0627\u0633\u0645 \u0623\u0648 \u0643\u0648\u062F \u0627\u0644\u0645\u0646\u062A\u062C \u0644\u0644\u0639\u062B\u0648\u0631 \u0639\u0644\u064A\u0647 \u0628\u0633\u0631\u0639\u0629":"Enter part of the name or product code to locate it quickly"," "),a(2),l("ngIf",r.searchLoading),a(),l("ngIf",!r.searchLoading&&r.searchControl.value&&!r.searchResults.length&&!r.searchError),a(),l("ngIf",r.searchError),a(),l("ngIf",r.searchResults.length),a(),l("ngIf",b(24,15,r.categories$)),a(2),l("ngIf",((n=b(26,17,r.categories$))==null?null:n.length)===0)}},dependencies:[ae,E,M,R,le,ue,et,G,z],styles:[".square-card[_ngcontent-%COMP%]{aspect-ratio:1/1;display:flex;flex-direction:column;width:100%;cursor:pointer;transition:transform .2s ease,box-shadow .2s ease;border:1px solid #eee;border-radius:.5rem;overflow:hidden}.square-card[_ngcontent-%COMP%]:hover{transform:scale(1.05);box-shadow:0 10px 20px #0000001a}.card-body[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:1rem}.square-card[_ngcontent-%COMP%]{border:2px solid #dee2e6;border-radius:.75rem;transition:border-color .2s ease}.square-card[_ngcontent-%COMP%]:hover{border-color:#007bff}"]})};function Jt(i,t){if(i&1&&g(0,"img",18),i&2){let e=u().$implicit,r=u(2);l("src",r.imageUrlService.getImageUrl(e.imagePath,r.serverUrl),ne)("alt",e.nameAr)}}function Xt(i,t){i&1&&(o(0,"div",19),g(1,"i",20),s())}function Zt(i,t){if(i&1&&(o(0,"p",21),c(1),f(2,"slice"),s()),i&2){let e=u().$implicit;a(),P(" ",U(2,2,e.description,0,40),"",e.description&&e.description.length>40?"...":""," ")}}function er(i,t){if(i&1){let e=I();o(0,"div",9)(1,"div",10),y("click",function(){let n=C(e).$implicit,d=u(2);return S(d.onCardClick(n.id))}),o(2,"div",11),v(3,Jt,1,2,"img",12)(4,Xt,2,0,"div",13),s(),o(5,"div",14)(6,"h3",15),c(7),s(),o(8,"div",16),v(9,Zt,3,6,"p",17),s()()()()}if(i&2){let e=t.$implicit;a(3),l("ngIf",e.imagePath),a(),l("ngIf",!e.imagePath),a(3),x(" ",e.nameAr," "),a(2),l("ngIf",e.description)}}function tr(i,t){if(i&1&&(o(0,"div",7),v(1,er,10,4,"div",8),s()),i&2){let e=t.ngIf;a(),l("ngForOf",e)}}function rr(i,t){i&1&&(o(0,"div",22)(1,"div",23),g(2,"i",24),s(),o(3,"h3",25),c(4,"\u0644\u0627 \u062A\u0648\u062C\u062F \u062A\u0635\u0646\u064A\u0641\u0627\u062A \u0641\u0631\u0639\u064A\u0629"),s(),o(5,"p",26),c(6,"\u0644\u0645 \u064A\u062A\u0645 \u0627\u0644\u0639\u062B\u0648\u0631 \u0639\u0644\u0649 \u0623\u064A \u062A\u0635\u0646\u064A\u0641\u0627\u062A \u0641\u0631\u0639\u064A\u0629 \u0645\u062A\u0627\u062D\u0629"),s()())}var be=class i{constructor(t,e,r,n,d,m,h){this.subCategoryService=t;this.lang=e;this.router=r;this.route=n;this.breadcrumbService=d;this.authService=m;this.imageUrlService=h;this.categories=this.route.snapshot.data.categoriesResolver}ngOnInit(){this.route.parent?.paramMap.subscribe(t=>{let e=t.get("orderTypeId");this.orderTypeId=e!==null?Number(e):1}),this.route.paramMap.subscribe(t=>{let e=t.get("categoryId");this.categoryId=e!==null?Number(e):1;let r=this.getCategoryName(this.categoryId),n=this.authService.isAdmin?"/admin/main":`/order/${this.orderTypeId}/categories`;this.breadcrumbService.setFrom([{label:"\u0627\u0644\u0631\u0626\u064A\u0633\u064A\u0629",route:n},{label:"\u0627\u0644\u062A\u0635\u0646\u064A\u0641\u0627\u062A",route:`/order/${this.orderTypeId}/categories`},{label:r,route:null}]),this.loadSubCategories(this.categoryId)})}subCategories$;orderTypeId=1;categoryId=1;categories;serverUrl=A.resourcesUrl;loadSubCategories(t){this.subCategories$=this.subCategoryService.GetSubCategoryByCategoryId(t).pipe(F(e=>e.filter(r=>this.authService.hasSubCategory(r.id))))}getCategoryName(t){return this.categories.find(e=>e.id===t)?.nameAr||"\u0627\u0644\u062A\u0635\u0646\u064A\u0641\u0627\u062A \u0627\u0644\u0641\u0631\u0639\u064A\u0629"}onCardClick(t){this.router.navigate(["/order",this.orderTypeId,"categories",this.categoryId,"sub-categories",t,"products"])}static \u0275fac=function(e){return new(e||i)(p(pt),p(W),p(k),p(T),p(B),p(w),p(N))};static \u0275cmp=O({type:i,selectors:[["app-order-sub-categories"]],standalone:!1,decls:11,vars:6,consts:[[1,"min-h-screen","bg-gray-50","py-8"],[1,"max-w-7xl","mx-auto","px-4","sm:px-6","lg:px-8"],[1,"text-center","mb-12"],[1,"text-3xl","font-bold","text-gray-900","mb-4"],[1,"text-lg","text-gray-600"],["class","grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6 xl:grid-cols-8 gap-6",4,"ngIf"],["class","text-center py-12",4,"ngIf"],[1,"grid","grid-cols-2","sm:grid-cols-3","md:grid-cols-4","lg:grid-cols-6","xl:grid-cols-8","gap-6"],["class","group h-full",4,"ngFor","ngForOf"],[1,"group","h-full"],[1,"bg-white","rounded-2xl","shadow-lg","hover:shadow-xl","transition-all","duration-300","transform","hover:scale-105","cursor-pointer","overflow-hidden","border","border-gray-100","h-full","flex","flex-col",3,"click"],[1,"aspect-square","bg-gradient-to-br","from-green-50","to-emerald-100","flex","items-center","justify-center","p-6","flex-shrink-0"],["class","w-full h-full object-cover rounded-xl",3,"src","alt",4,"ngIf"],["class","w-16 h-16 bg-gradient-to-br from-green-500 to-emerald-600 rounded-2xl flex items-center justify-center",4,"ngIf"],[1,"p-4","text-center","flex","flex-col","flex-grow"],[1,"font-bold","text-gray-900","text-sm","mb-1","group-hover:text-green-600","transition-colors"],[1,"flex-grow","flex","items-center","justify-center"],["class","text-gray-500 text-xs leading-relaxed",4,"ngIf"],[1,"w-full","h-full","object-cover","rounded-xl",3,"src","alt"],[1,"w-16","h-16","bg-gradient-to-br","from-green-500","to-emerald-600","rounded-2xl","flex","items-center","justify-center"],[1,"bi","bi-tags","text-white","text-2xl"],[1,"text-gray-500","text-xs","leading-relaxed"],[1,"text-center","py-12"],[1,"w-24","h-24","bg-gray-100","rounded-full","flex","items-center","justify-center","mx-auto","mb-4"],[1,"bi","bi-tags","text-gray-400","text-3xl"],[1,"text-lg","font-semibold","text-gray-900","mb-2"],[1,"text-gray-500"]],template:function(e,r){if(e&1&&(o(0,"div",0)(1,"div",1)(2,"div",2)(3,"h1",3),c(4,"\u0627\u062E\u062A\u0631 \u0627\u0644\u062A\u0635\u0646\u064A\u0641 \u0627\u0644\u0641\u0631\u0639\u064A"),s(),o(5,"p",4),c(6,"\u0627\u062E\u062A\u0631 \u0627\u0644\u062A\u0635\u0646\u064A\u0641 \u0627\u0644\u0641\u0631\u0639\u064A \u0627\u0644\u0645\u0646\u0627\u0633\u0628 \u0644\u062A\u0635\u0641\u062D \u0627\u0644\u0645\u0646\u062A\u062C\u0627\u062A"),s()(),v(7,tr,2,1,"div",5),f(8,"async"),v(9,rr,7,0,"div",6),f(10,"async"),s()()),e&2){let n;a(7),l("ngIf",b(8,2,r.subCategories$)),a(2),l("ngIf",((n=b(10,4,r.subCategories$))==null?null:n.length)===0)}},dependencies:[E,M,G,z],styles:[".square-card[_ngcontent-%COMP%]{aspect-ratio:1/1;display:flex;flex-direction:column;width:100%;cursor:pointer;transition:transform .2s ease,box-shadow .2s ease,border-color .2s ease;border:2px solid #dee2e6;border-radius:.75rem;overflow:hidden}.square-card[_ngcontent-%COMP%]:hover{transform:scale(1.05);box-shadow:0 10px 20px #0000001a;border-color:#007bff}.card-body[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:1rem}"]})};function nr(i,t){if(i&1&&(o(0,"div",32)(1,"div",33)(2,"div",34),g(3,"i",35),o(4,"div")(5,"div",36),c(6),s(),o(7,"div",37),c(8),s()()(),o(9,"span",38),c(10),s()()()),i&2){let e=t.$implicit,r=u(2).$implicit;a(6),_(e.store==null?null:e.store.nameAr),a(2),_(e.store==null?null:e.store.code),a(2),P("",e.quantity," ",r==null||r.unit==null?null:r.unit.nameAr)}}function or(i,t){if(i&1&&(o(0,"div",27)(1,"div",28)(2,"span",29),c(3,"\u0627\u0644\u0645\u062E\u0632\u0648\u0646 \u0627\u0644\u0631\u0626\u064A\u0633\u064A"),s()(),o(4,"div",30),v(5,nr,11,4,"div",31),s()()),i&2){let e=u().$implicit,r=u();a(5),l("ngForOf",r.getMainProductInventories(e))}}function ar(i,t){if(i&1&&(o(0,"div",44)(1,"div",34),g(2,"i",45),o(3,"span",46),c(4),s()(),o(5,"span",39),c(6),s()()),i&2){let e=t.$implicit,r=u().$implicit,n=u(2).$implicit,d=u();a(4),_(e.name),a(2),P(" ",d.getVariantStockForStore(n.id,r.id,e.id)," ",n==null||n.unit==null?null:n.unit.nameAr," ")}}function sr(i,t){if(i&1&&(o(0,"div",41)(1,"div",28)(2,"div",34),g(3,"i",42),o(4,"span",36),c(5),s()()(),o(6,"div",30),v(7,ar,7,3,"div",43),s()()),i&2){let e=t.$implicit,r=u(2).$implicit,n=u();a(5),_(e.name),a(2),l("ngForOf",n.getStoresForVariant(r,e.id))}}function dr(i,t){if(i&1&&(o(0,"div",27)(1,"div",28)(2,"span",29),c(3,"\u0627\u0644\u0645\u062A\u063A\u064A\u0631\u0627\u062A"),s(),o(4,"span",39),c(5),s()(),o(6,"div",30),v(7,sr,8,2,"div",40),s()()),i&2){let e=u().$implicit,r=u();a(5),_(r.getTotalVariantsWithStock(e)),a(2),l("ngForOf",e.variants)}}function cr(i,t){i&1&&(o(0,"div",47),g(1,"i",48),o(2,"span",49),c(3),f(4,"translate"),s()()),i&2&&(a(3),_(b(4,1,"ORDER.NO_STOCK")))}function lr(i,t){if(i&1){let e=I();o(0,"div",11)(1,"div",12),y("click",function(){let n=C(e).$implicit,d=u();return S(d.viewProductDetail(n))}),o(2,"div",13),g(3,"app-image-uploader",14),s(),o(4,"div",15)(5,"h3",16),c(6),s(),o(7,"p",17),c(8),f(9,"slice"),s(),o(10,"div",18)(11,"span",19),c(12),f(13,"currency"),s(),o(14,"span",20),c(15),s()(),o(16,"div",21),v(17,or,6,1,"div",22)(18,dr,8,2,"div",22)(19,cr,5,3,"div",23),s(),o(20,"div",24)(21,"button",25),y("click",function(n){let d=C(e).$implicit;return u().viewProductDetail(d),S(n.stopPropagation())}),g(22,"i",26),c(23," \u0639\u0631\u0636 \u0627\u0644\u062A\u0641\u0627\u0635\u064A\u0644 "),s()()()()()}if(i&2){let e=t.$implicit,r=u();a(3),l("initialImageUrl",r.imageUrlService.getImageUrl(e.imagePath,r.serverUrl))("readonly",!0),a(3),x(" ",e.nameAr," "),a(),l("title",e.description),a(),P(" ",U(9,11,e.description,0,60),"",((e.description==null?null:e.description.length)||0)>60?"...":""," "),a(4),_(b(13,15,e.sellingPrice)),a(3),_(e.unit==null?null:e.unit.nameAr),a(2),l("ngIf",!e.variants||e.variants.length===0||!r.hasVariantStock(e)),a(),l("ngIf",e.variants&&e.variants.length>0&&r.hasVariantStock(e)),a(),l("ngIf",(!e.inventories||e.inventories.length===0)&&(!e.variants||e.variants.length===0))}}function ur(i,t){i&1&&(o(0,"div",50)(1,"div",51),g(2,"i",52),s(),o(3,"h3",53),c(4),f(5,"translate"),s(),o(6,"p",54),c(7),f(8,"translate"),s()()),i&2&&(a(4),_(b(5,2,"ORDER_MANAGEMENT.NO_PRODUCTS_IN_CATEGORY")),a(3),_(b(8,4,"ORDER_MANAGEMENT.CHOOSE_OTHER_CATEGORY")))}var he=class i{constructor(t,e,r,n,d,m,h,J,X){this.route=t;this.router=e;this.productsService=r;this.cartService=n;this.fb=d;this.breadcrumbService=m;this.orderBreadcrumbService=h;this.authService=J;this.imageUrlService=X;this.subCategories=this.route.snapshot.data.subCategoriesResolver}ngOnInit(){this.serverUrl=this.productsService.url.substring(0,this.productsService.url.indexOf("api")),this.route.parent?.paramMap.subscribe(t=>{let e=t.get("orderTypeId");this.orderTypeId=e!==null?Number(e):1,this.cartService.setOrderTypeId(this.orderTypeId)}),this.route.paramMap.subscribe(t=>{let e=t.get("categoryId"),r=t.get("subCategoryId");this.categoryId=e!==null?Number(e):1,this.subCategoryId=r!==null?Number(r):1;let n=this.subCategories.find(h=>h.id===this.subCategoryId),d=n?.category?.nameAr||"\u0627\u0644\u062A\u0635\u0646\u064A\u0641",m=n?.nameAr||"\u0627\u0644\u0645\u0646\u062A\u062C\u0627\u062A";this.orderBreadcrumbService.setOrderProductsBreadcrumbs(this.orderTypeId,this.categoryId,d,this.subCategoryId,m),this.loadProducts(this.subCategoryId)})}orderTypeId;categoryId;subCategoryId;products$;resourcesUrl=A.resourcesUrl;subCategories;selectedSubCategory;serverUrl="";variantStockData={};loadProducts(t){this.products$=this.productsService.GetProductsBySubCategoryId(t).pipe(Z(e=>{console.log("Products from API:",e),console.log("User product permissions:",this.authService.getProductIds()),this.loadVariantStockData(e)}),F(e=>{let r=e.filter(n=>{let d=this.authService.hasProduct(n.id);return console.log(`Product ${n.id} (${n.nameEn}): hasPermission = ${d}`),d});return console.log("Filtered products:",r),r})),this.selectedSubCategory=this.subCategories.find(e=>e.id===t)}loadVariantStockData(t){console.log("\u{1F50D} Loading variant stock data for products:",t.length),t.forEach(e=>{console.log(`\u{1F4E6} Product ${e.id} (${e.nameAr}):`,{inventories:e.inventories?.length||0,variants:e.variants?.length||0}),e.inventories&&e.inventories.length>0&&e.inventories.forEach(r=>{if(console.log("\u{1F4CA} Inventory record:",{productId:r.productId,storeId:r.storeId,variantId:r.variantId,quantity:r.quantity,storeName:r.store?.nameAr}),r.variantId){let n=`${e.id}-${r.variantId}-${r.storeId}`;this.variantStockData[n]=r.quantity,console.log(`\u2705 Added variant stock: ${n} = ${r.quantity}`)}})}),console.log("\u{1F4C8} Final variant stock data:",this.variantStockData)}getVariantStock(t,e,r){return this.variantStockData[`${t}-${e}-${r}`]||0}getVariantStockForStore(t,e,r){return this.getVariantStock(t,e,r)}hasVariantStock(t){return!t.variants||t.variants.length===0?!1:t.variants.some(e=>this.getStoresForVariant(t,e.id).length>0)}getMainProductInventories(t){return t.inventories?.filter(e=>!e.variantId)||[]}getTotalVariantsWithStock(t){return t.variants?t.variants.filter(e=>this.getStoresForVariant(t,e.id).length>0).length:0}getStoresForVariant(t,e){let r=[];if(console.log(`\u{1F50D} Getting stores for variant ${e} of product ${t.id}:`,{productInventories:t.inventories?.length||0,productVariants:t.variants?.length||0}),t&&t.inventories){let n=t.inventories.filter(d=>d.variantId===e&&d.quantity>0);console.log(`\u{1F4CA} Found ${n.length} inventory records for variant ${e}:`,n),n.forEach(d=>{if(console.log("\u{1F3EA} Processing inventory:",{storeId:d.storeId,storeName:d.store?.nameAr,quantity:d.quantity}),d.store){let m={id:d.store.id,name:d.store.nameAr||`\u0645\u0633\u062A\u0648\u062F\u0639 ${d.store.id}`,code:d.store.code||`S${d.store.id}`,isActive:!0};r.push(m),console.log("\u2705 Added store:",m)}})}return console.log(`\u{1F3AF} Final stores for variant ${e}:`,r),r}viewProductDetail(t){this.router.navigate(["/order",this.orderTypeId,"product",t.id])}static \u0275fac=function(e){return new(e||i)(p(T),p(k),p(Y),p(K),p(H),p(B),p(j),p(w),p(N))};static \u0275cmp=O({type:i,selectors:[["app-order-products"]],standalone:!1,decls:19,vars:14,consts:[["dir","rtl",1,"min-h-screen","bg-gray-50","py-8"],[1,"max-w-7xl","mx-auto","px-4","sm:px-6","lg:px-8"],[1,"mb-8"],[1,"flex","flex-col","sm:flex-row","justify-between","items-start","sm:items-center","gap-4"],[1,"text-3xl","font-bold","text-gray-900","mb-2"],[1,"flex","items-center","text-gray-600"],[1,"bi","bi-cart3","mr-2"],[1,"text-lg"],[1,"grid","grid-cols-1","sm:grid-cols-2","md:grid-cols-3","lg:grid-cols-4","xl:grid-cols-5","gap-6"],["class","group",4,"ngFor","ngForOf"],["class","text-center py-12",4,"ngIf"],[1,"group"],[1,"bg-white","rounded-2xl","shadow-lg","hover:shadow-xl","transition-all","duration-300","transform","hover:scale-105","cursor-pointer","overflow-hidden","border","border-gray-100",3,"click"],[1,"aspect-square","bg-gradient-to-br","from-gray-50","to-gray-100","flex","items-center","justify-center","p-4"],[3,"initialImageUrl","readonly"],[1,"p-4"],[1,"font-bold","text-gray-900","text-sm","mb-2","group-hover:text-blue-600","transition-colors","line-clamp-2"],[1,"text-gray-500","text-xs","mb-3","line-clamp-2",3,"title"],[1,"flex","justify-between","items-center","mb-3"],[1,"font-bold","text-green-600","text-lg"],[1,"text-gray-500","text-xs","bg-gray-100","px-2","py-1","rounded-full"],[1,"mb-3"],["class","mb-2",4,"ngIf"],["class","text-center p-2 bg-yellow-50 rounded-lg",4,"ngIf"],[1,"mt-auto"],[1,"w-full","bg-blue-600","text-white","py-2","px-3","rounded-lg","text-xs","font-semibold","hover:bg-blue-700","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:ring-offset-2","transition-colors",3,"click"],[1,"bi","bi-eye","mr-1"],[1,"mb-2"],[1,"flex","justify-between","items-center","mb-1"],[1,"text-gray-500","text-xs","font-semibold"],[1,"space-y-1"],["class","bg-gray-50 p-2 rounded-lg",4,"ngFor","ngForOf"],[1,"bg-gray-50","p-2","rounded-lg"],[1,"flex","justify-between","items-center"],[1,"flex","items-center"],[1,"bi","bi-building","text-blue-600","mr-2","text-xs"],[1,"text-xs","font-semibold","text-gray-900"],[1,"text-gray-500","text-xs"],[1,"bg-green-100","text-green-800","text-xs","px-2","py-1","rounded-full"],[1,"bg-blue-100","text-blue-800","text-xs","px-2","py-1","rounded-full"],["class","bg-blue-50 p-2 rounded-lg",4,"ngFor","ngForOf"],[1,"bg-blue-50","p-2","rounded-lg"],[1,"bi","bi-tag","text-blue-600","mr-2","text-xs"],["class","flex justify-between items-center p-1 bg-white rounded",4,"ngFor","ngForOf"],[1,"flex","justify-between","items-center","p-1","bg-white","rounded"],[1,"bi","bi-building","text-blue-600","mr-1","text-xs"],[1,"text-xs","text-gray-900"],[1,"text-center","p-2","bg-yellow-50","rounded-lg"],[1,"bi","bi-exclamation-triangle","text-yellow-600","text-xs"],[1,"text-yellow-600","text-xs","mr-1"],[1,"text-center","py-12"],[1,"w-24","h-24","bg-gray-100","rounded-full","flex","items-center","justify-center","mx-auto","mb-4"],[1,"bi","bi-box","text-gray-400","text-3xl"],[1,"text-lg","font-semibold","text-gray-900","mb-2"],[1,"text-gray-500"]],template:function(e,r){if(e&1&&(o(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div")(5,"h1",4),c(6),f(7,"translate"),s(),o(8,"div",5),g(9,"i",6),o(10,"span",7),c(11),f(12,"translate"),f(13,"translate"),s()()()()(),o(14,"div",8),v(15,lr,24,17,"div",9),f(16,"async"),s(),v(17,ur,9,6,"div",10),f(18,"async"),s()()),e&2){let n;a(6),_(r.selectedSubCategory&&r.selectedSubCategory.nameAr||b(7,4,"ORDER.PRODUCTS")),a(5),_(r.orderTypeId===1?b(12,6,"PURCHASE.TITLE"):b(13,8,"SALE.TITLE")),a(4),l("ngForOf",b(16,10,r.products$)),a(2),l("ngIf",((n=b(18,12,r.products$))==null?null:n.length)===0)}},dependencies:[E,M,pe,R,G,z,se,me],styles:[".product-card[_ngcontent-%COMP%]{transition:transform .3s ease,box-shadow .3s ease;cursor:pointer;border-radius:.75rem}.product-card[_ngcontent-%COMP%]:hover{transform:translateY(-5px);box-shadow:0 8px 25px #00000026!important}.card[_ngcontent-%COMP%]{border-radius:.75rem}.card[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{transition:transform .2s ease}.card[_ngcontent-%COMP%]:hover   img[_ngcontent-%COMP%]{transform:scale(1.05)}.card-img-top[_ngcontent-%COMP%]{height:200px;object-fit:cover}.card-body[_ngcontent-%COMP%]{margin-top:0!important;margin-bottom:0!important;padding-top:.5rem;padding-bottom:.5rem}.card-title[_ngcontent-%COMP%]{font-size:1rem;line-height:1.3;min-height:2.6rem;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden}.card-text[_ngcontent-%COMP%]{font-size:.875rem;line-height:1.4;min-height:2.8rem;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden}.btn[_ngcontent-%COMP%]{border-radius:8px;font-weight:500;transition:all .3s ease}.btn[_ngcontent-%COMP%]:hover{transform:translateY(-1px)}.text-primary[_ngcontent-%COMP%]{font-weight:700}.fa-box-open[_ngcontent-%COMP%]{opacity:.5}.compact-stock-list[_ngcontent-%COMP%]{max-height:200px;overflow-y:auto}.compact-stock-list[_ngcontent-%COMP%]   .stock-item[_ngcontent-%COMP%]{transition:all .2s ease;border:1px solid rgba(0,0,0,.05);background-color:#f8f9fa80;margin-bottom:.5rem;padding:.75rem}.compact-stock-list[_ngcontent-%COMP%]   .stock-item[_ngcontent-%COMP%]:hover{background-color:#0d6efd0d!important;border-color:#0d6efd33;transform:translate(1px)}.compact-stock-list[_ngcontent-%COMP%]   .stock-item[_ngcontent-%COMP%]:last-child{margin-bottom:0}.compact-stock-list[_ngcontent-%COMP%]   .stock-item[_ngcontent-%COMP%]   .badge[_ngcontent-%COMP%]{font-size:.7rem;padding:.3em .5em}.variants-for-store[_ngcontent-%COMP%]{margin-top:.5rem;padding-top:.5rem;border-top:1px solid rgba(0,0,0,.1)}.variants-for-store[_ngcontent-%COMP%]   .variants-list[_ngcontent-%COMP%]{max-height:100px;overflow-y:auto}.variants-for-store[_ngcontent-%COMP%]   .variants-list[_ngcontent-%COMP%]   .variant-item[_ngcontent-%COMP%]{transition:all .2s ease;border:1px solid rgba(0,0,0,.05);background-color:#f8f9fa4d;margin-bottom:.25rem;padding:.4rem}.variants-for-store[_ngcontent-%COMP%]   .variants-list[_ngcontent-%COMP%]   .variant-item[_ngcontent-%COMP%]:hover{background-color:#0dcaf00d!important;border-color:#0dcaf033;transform:translate(1px)}.variants-for-store[_ngcontent-%COMP%]   .variants-list[_ngcontent-%COMP%]   .variant-item[_ngcontent-%COMP%]:last-child{margin-bottom:0}.variants-for-store[_ngcontent-%COMP%]   .variants-list[_ngcontent-%COMP%]   .variant-item[_ngcontent-%COMP%]   .badge[_ngcontent-%COMP%]{font-size:.65rem;padding:.25em .4em}.variant-stock-item[_ngcontent-%COMP%]{transition:all .2s ease;border:1px solid rgba(0,0,0,.05);background-color:#f8f9fa80;margin-bottom:.5rem;padding:.75rem}.variant-stock-item[_ngcontent-%COMP%]:hover{background-color:#0dcaf00d!important;border-color:#0dcaf033;transform:translate(1px)}.variant-stock-item[_ngcontent-%COMP%]:last-child{margin-bottom:0}.stores-for-variant[_ngcontent-%COMP%]{margin-top:.5rem;padding-top:.5rem;border-top:1px solid rgba(0,0,0,.1)}.stores-for-variant[_ngcontent-%COMP%]   .store-variant-item[_ngcontent-%COMP%]{transition:all .2s ease;border:1px solid rgba(0,0,0,.05);background-color:#f8f9fa4d;margin-bottom:.25rem;padding:.4rem}.stores-for-variant[_ngcontent-%COMP%]   .store-variant-item[_ngcontent-%COMP%]:hover{background-color:#0d6efd0d!important;border-color:#0d6efd33;transform:translate(1px)}.stores-for-variant[_ngcontent-%COMP%]   .store-variant-item[_ngcontent-%COMP%]:last-child{margin-bottom:0}.stores-for-variant[_ngcontent-%COMP%]   .store-variant-item[_ngcontent-%COMP%]   .badge[_ngcontent-%COMP%]{font-size:.65rem;padding:.25em .4em}@media (max-width: 768px){.product-card[_ngcontent-%COMP%]{margin-bottom:1rem}.card-img-top[_ngcontent-%COMP%]{height:150px}.card-title[_ngcontent-%COMP%]{font-size:.9rem;min-height:2.2rem}.card-text[_ngcontent-%COMP%]{font-size:.8rem;min-height:2.4rem}}"]})};function pr(i,t){if(i&1&&(o(0,"div",12)(1,"div",13),c(2),s(),g(3,"input",14),s()),i&2){let e=t.$implicit,r=t.index;l("formGroupName",r),a(2),_(e.value.name)}}function gr(i,t){i&1&&(o(0,"span",15),c(1,"\u064A\u062C\u0628 \u0623\u0646 \u064A\u0633\u0627\u0648\u064A \u0627\u0644\u0645\u062C\u0645\u0648\u0639 \u0627\u0644\u0643\u0645\u064A\u0629 \u0627\u0644\u0639\u0627\u0645\u0629"),s())}var xe=class i{constructor(t,e,r){this.fb=t;this.dialogRef=e;this.data=r;this.generalQuantity=r.generalInventory.quantity,this.allocationForm=this.fb.group({allocations:this.fb.array(r.variants.map(n=>this.fb.group({variantId:[n.id],name:[n.name],quantity:[0,[q.required,q.min(0)]]})))}),this.onChanges()}allocationForm;totalAssigned=0;generalQuantity;allocations(){return this.allocationForm.get("allocations")}onChanges(){this.allocationForm.valueChanges.subscribe(t=>{this.totalAssigned=t.allocations.map(e=>+e.quantity).reduce((e,r)=>e+r,0)})}isAllocationValid(){return this.totalAssigned===this.generalQuantity&&this.allocationForm.valid}submit(){if(!this.isAllocationValid())return;let t={productId:this.data.product.id,storeId:this.data.generalInventory.storeId,generalInventoryId:this.data.generalInventory.id,generalQuantity:this.generalQuantity,allocations:this.allocationForm.value.allocations.filter(e=>+e.quantity>0).map(e=>({variantId:e.variantId,quantity:+e.quantity}))};this.dialogRef.close(t)}close(){this.dialogRef.close()}static \u0275fac=function(e){return new(e||i)(p(H),p(dt),p(ct))};static \u0275cmp=O({type:i,selectors:[["app-split-general-quantity-dialog"]],decls:22,vars:8,consts:[[1,"text-xl","font-bold","text-gray-800","mb-3","text-center"],[1,"mb-4","text-gray-600","leading-loose","text-center"],[1,"font-bold","text-green-700"],[3,"ngSubmit","formGroup"],[1,"space-y-4"],["class","flex justify-between items-center bg-gray-50 px-3 py-2 rounded-lg",3,"formGroupName",4,"ngFor","ngForOf"],[1,"text-right","mt-4"],[1,"font-bold"],["class","text-red-500 ml-2",4,"ngIf"],[1,"mt-6","flex","gap-3","justify-end"],["type","button",1,"px-5","py-2","rounded","bg-gray-200","text-gray-700","font-semibold","hover:bg-gray-300",3,"click"],["type","submit","[disabled]!","!isAllocationValid()",1,"px-7","py-2","rounded","bg-green-600","text-white","font-semibold","shadow","hover:bg-green-700","disabled:opacity-50","disabled:cursor-not-allowed"],[1,"flex","justify-between","items-center","bg-gray-50","px-3","py-2","rounded-lg",3,"formGroupName"],[1,"text-gray-800","font-semibold"],["type","number","formControlName","quantity","min","0",1,"w-24","px-2","py-1","border","rounded","text-center","focus:outline-none"],[1,"text-red-500","ml-2"]],template:function(e,r){e&1&&(o(0,"h2",0),c(1,"\u0642\u0633\u0651\u0645 \u0627\u0644\u0643\u0645\u064A\u0629 \u0627\u0644\u0639\u0627\u0645\u0629 \u0639\u0644\u0649 \u0627\u0644\u0645\u062A\u063A\u064A\u0631\u0627\u062A"),s(),o(2,"div",1),c(3," \u0627\u0644\u0643\u0645\u064A\u0629 \u0627\u0644\u0639\u0627\u0645\u0629 \u0627\u0644\u062D\u0627\u0644\u064A\u0629: "),o(4,"span",2),c(5),s()(),o(6,"form",3),y("ngSubmit",function(){return r.submit()}),o(7,"div",4),v(8,pr,4,2,"div",5),s(),o(9,"div",6),c(10," \u0645\u062C\u0645\u0648\u0639 \u0627\u0644\u062A\u0648\u0632\u064A\u0639: "),o(11,"span"),c(12),s(),c(13," / "),o(14,"span",7),c(15),s(),v(16,gr,2,0,"span",8),s(),o(17,"div",9)(18,"button",10),y("click",function(){return r.close()}),c(19,"\u0625\u0644\u063A\u0627\u0621"),s(),o(20,"button",11),c(21," \u062A\u0648\u0632\u064A\u0639 \u0627\u0644\u0643\u0645\u064A\u0629 "),s()()()),e&2&&(a(5),_(r.generalQuantity),a(),l("formGroup",r.allocationForm),a(2),l("ngForOf",r.allocations().controls),a(3),je("text-red-600",r.totalAssigned!==r.generalQuantity),a(),_(r.totalAssigned),a(3),_(r.generalQuantity),a(),l("ngIf",r.totalAssigned!==r.generalQuantity))},dependencies:[de,E,M,ot,Xe,le,Ze,ue,Ke,nt,tt,it,rt],styles:[".dialog-container[_ngcontent-%COMP%]{padding:1.5rem;border-radius:1em}input[type=number][_ngcontent-%COMP%]{border:1px solid #ddd}input[type=number][_ngcontent-%COMP%]:focus{outline:none;border-color:#059669;box-shadow:0 0 0 2px #bbf7d0}button[type=submit][_ngcontent-%COMP%]:not(:disabled){background:linear-gradient(to right,#059669,#34d399)}"]})};var _e=class i{constructor(t){this.http=t}apiUrl=`${A.baseUrl}/ProductVariants`;getProductVariantsByProductId(t){return this.http.get(`${this.apiUrl}/by-product/${t}`)}static \u0275fac=function(e){return new(e||i)(V(ce))};static \u0275prov=L({token:i,factory:i.\u0275fac,providedIn:"root"})};var ye=class i{constructor(t){this.http=t}apiUrl=`${A.baseUrl}/ProductModifiers`;getProductModifiersByProductId(t){return this.http.get(`${this.apiUrl}/groups/by-product/${t}`)}getModifierOptions(t){return this.http.get(`${this.apiUrl}/${t}/options`)}static \u0275fac=function(e){return new(e||i)(V(ce))};static \u0275prov=L({token:i,factory:i.\u0275fac,providedIn:"root"})};var hr=()=>[];function xr(i,t){if(i&1){let e=I();o(0,"div",31)(1,"div",32)(2,"div",33),g(3,"i",34),s(),o(4,"div",35)(5,"h4",36),c(6," \u064A\u0631\u062C\u0649 \u0625\u0646\u0634\u0627\u0621 \u0645\u062A\u063A\u064A\u0631 \u0648\u0627\u062D\u062F \u0639\u0644\u0649 \u0627\u0644\u0623\u0642\u0644 \u0642\u0628\u0644 \u0625\u0636\u0627\u0641\u0629 \u0627\u0644\u0643\u0645\u064A\u0629 "),s(),o(7,"p",37),c(8," \u0644\u0625\u062F\u0627\u0631\u0629 \u0623\u0641\u0636\u0644 \u0644\u0644\u0645\u062E\u0632\u0648\u0646\u060C \u064A\u062C\u0628 \u0625\u0646\u0634\u0627\u0621 \u0645\u062A\u063A\u064A\u0631 \u0648\u0627\u062D\u062F \u0639\u0644\u0649 \u0627\u0644\u0623\u0642\u0644 \u0644\u0644\u0645\u0646\u062A\u062C \u0642\u0628\u0644 \u0625\u0636\u0627\u0641\u0629 \u0623\u064A \u0643\u0645\u064A\u0629. \u064A\u0645\u0643\u0646\u0643 \u0625\u0646\u0634\u0627\u0621 \u0645\u062A\u063A\u064A\u0631\u0627\u062A \u0645\u062B\u0644 (\u0635\u063A\u064A\u0631\u060C \u0645\u062A\u0648\u0633\u0637\u060C \u0643\u0628\u064A\u0631) \u0623\u0648 \u0623\u064A \u062A\u0635\u0646\u064A\u0641 \u0622\u062E\u0631 \u0645\u0646\u0627\u0633\u0628. "),s(),o(9,"button",38),y("click",function(){C(e);let n=u(4);return S(n.goToProductForm())}),g(10,"i",39),c(11," \u0625\u0646\u0634\u0627\u0621 \u0645\u062A\u063A\u064A\u0631\u0627\u062A \u0644\u0644\u0645\u0646\u062A\u062C "),s()()()()}}function _r(i,t){if(i&1){let e=I();o(0,"div",41)(1,"div",20)(2,"div",42),g(3,"i",43),o(4,"div")(5,"div",44),c(6),s(),o(7,"div",45),c(8),s()()(),o(9,"div",42)(10,"span",46),c(11),f(12,"translate"),s(),o(13,"div",47)(14,"button",48),y("click",function(){let n=C(e).$implicit,d=u(5);return S(d.decreaseQuantity(d.product.id,n.id))}),g(15,"i",49),s(),o(16,"input",50),y("change",function(n){let d=C(e).$implicit,m=u(5);return S(m.setProductQuantity(m.product.id,d.id,n))}),s(),o(17,"button",51),y("click",function(){let n=C(e).$implicit,d=u(5);return S(d.increaseQuantity(d.product.id,n.id))}),g(18,"i",52),s()()()(),o(19,"div",53)(20,"span",54),c(21),f(22,"translate"),o(23,"span",55),c(24),s()()()()}if(i&2){let e=t.$implicit,r=u(5);a(6),_(e.name),a(2),_(e.code),a(3),x("",b(12,10,"ORDER.QUANTITY"),":"),a(3),l("disabled",r.getCartQuantityForProductStore(r.product.id,e.id)===0),a(2),l("value",r.getCartQuantityForProductStore(r.product.id,e.id))("max",r.getStoreQuantity(e.id)),a(),l("disabled",r.getStoreQuantity(e.id)<=r.getCartQuantityForProductStore(r.product.id,e.id)),a(4),x(" ",b(22,12,"ORDER.AVAILABLE_STOCK"),": "),a(3),P("",r.getStoreQuantity(e.id)," ",r.product.unit==null?null:r.product.unit.nameAr)}}function yr(i,t){if(i&1&&(o(0,"div",11),v(1,_r,25,14,"div",40),s()),i&2){let e=u(4);a(),l("ngForOf",e.allStores)}}function Cr(i,t){if(i&1&&(o(0,"div"),v(1,xr,12,0,"div",29)(2,yr,2,1,"div",30),s()),i&2){let e=u(3);a(),l("ngIf",e.orderTypeId===1),a(),l("ngIf",e.orderTypeId===2)}}function Sr(i,t){if(i&1&&(o(0,"span",65),c(1),f(2,"currency"),s()),i&2){let e=u().$implicit;a(),x(" (+",b(2,1,e.priceAdjustment),") ")}}function Ir(i,t){if(i&1){let e=I();o(0,"div",66)(1,"div",20)(2,"div",42),g(3,"i",43),o(4,"div")(5,"div",44),c(6),s(),o(7,"div",45),c(8),s()()(),o(9,"div",42)(10,"span",46),c(11),f(12,"translate"),s(),o(13,"div",47)(14,"button",48),y("click",function(){let n=C(e).$implicit,d=u().$implicit,m=u(4);return S(m.decreaseVariantQuantity(d.id,n.id))}),g(15,"i",49),s(),o(16,"input",50),y("change",function(n){let d=C(e).$implicit,m=u().$implicit,h=u(4);return S(h.setVariantQuantity(m.id,d.id,n))}),s(),o(17,"button",51),y("click",function(){let n=C(e).$implicit,d=u().$implicit,m=u(4);return S(m.increaseVariantQuantity(d.id,n.id))}),g(18,"i",52),s()()()(),o(19,"div",53)(20,"span",54),c(21),f(22,"translate"),o(23,"span",55),c(24),s()()()()}if(i&2){let e=t.$implicit,r=u().$implicit,n=u(4);a(6),_(e.name),a(2),_(e.code),a(3),x("",b(12,10,"ORDER.QUANTITY"),":"),a(3),l("disabled",n.getCartQuantityForVariantStore(r.id,e.id)===0),a(2),l("value",n.getCartQuantityForVariantStore(r.id,e.id))("max",n.orderTypeId===1?999999:n.getVariantStockForStore(r.id,e.id)),a(),l("disabled",n.orderTypeId===2&&n.getVariantStockForStore(r.id,e.id)<=n.getCartQuantityForVariantStore(r.id,e.id)),a(4),x(" ",b(22,12,"ORDER.AVAILABLE_STOCK"),": "),a(3),P("",n.getVariantStockForStore(r.id,e.id)," ",n.product.unit==null?null:n.product.unit.nameAr)}}function Pr(i,t){i&1&&(o(0,"div",67)(1,"div",42),g(2,"i",68),o(3,"span",69),c(4),f(5,"translate"),s()()()),i&2&&(a(4),x(" ",b(5,1,"ORDER_MANAGEMENT.NO_VARIANTS_STOCK")," "))}function Or(i,t){if(i&1&&(o(0,"div",57)(1,"div",58)(2,"h4",59),g(3,"i",60),c(4),v(5,Sr,3,3,"span",61),s()(),o(6,"div",62),v(7,Ir,25,14,"div",63)(8,Pr,6,3,"div",64),s()()),i&2){let e=t.$implicit,r=u(4);a(4),x(" ",e.name," "),a(),l("ngIf",e.priceAdjustment),a(2),l("ngForOf",r.getStoresForVariant(e.id)),a(),l("ngIf",r.getStoresForVariant(e.id).length===0&&r.orderTypeId===2)}}function Mr(i,t){if(i&1&&(o(0,"div",15),v(1,Or,9,4,"div",56),s()),i&2){let e=u(3);a(),l("ngForOf",e.productVariants)}}function Ar(i,t){i&1&&(o(0,"span",72),c(1),f(2,"translate"),s()),i&2&&(a(),x(" ",b(2,1,"ORDER_MANAGEMENT.NO_VARIANTS_STOCK")," "))}function wr(i,t){i&1&&(o(0,"span",72),c(1),f(2,"translate"),s()),i&2&&(a(),_(b(2,1,"ORDER_MANAGEMENT.NO_PRODUCT_STOCK")))}function Er(i,t){if(i&1&&(o(0,"div",70)(1,"div",42),g(2,"i",68),v(3,Ar,3,3,"span",71)(4,wr,3,3,"ng-template",null,0,He),s()()),i&2){let e=Be(5),r=u(3);a(3),l("ngIf",r.productVariants.length>0)("ngIfElse",e)}}function Tr(i,t){i&1&&(o(0,"span",77),c(1,"*"),s())}function kr(i,t){if(i&1&&(o(0,"span",81),c(1),f(2,"currency"),s()),i&2){let e=u().$implicit;a(),x(" (+",b(2,1,e.priceAdjustment),") ")}}function Dr(i,t){if(i&1){let e=I();o(0,"div",42)(1,"input",78),y("change",function(n){let d=C(e).$implicit,m=u().$implicit,h=u(3);return S(h.onModifierChange(m.modifierId,d.id,n.target.checked))}),s(),o(2,"label",79),c(3),v(4,kr,3,3,"span",80),s()()}if(i&2){let e=t.$implicit,r=u().$implicit,n=u(3);a(),l("id","modifier_"+r.modifierId+"_"+e.id)("checked",n.isModifierOptionSelected(r.modifierId,e.id)),a(),l("for","modifier_"+r.modifierId+"_"+e.id),a(),x(" ",e.name," "),a(),l("ngIf",e.priceAdjustment)}}function Fr(i,t){if(i&1&&(o(0,"div",6)(1,"label",73),c(2),v(3,Tr,2,0,"span",74),s(),o(4,"div",75),v(5,Dr,5,5,"div",76),s()()),i&2){let e=t.$implicit;a(2),x(" ",e.modifierName||(e.modifier==null?null:e.modifier.name)," "),a(),l("ngIf",e.isRequired),a(2),l("ngForOf",(e.modifier==null?null:e.modifier.options)||Ge(3,hr))}}function Vr(i,t){if(i&1&&(o(0,"div",6)(1,"div",82)(2,"h4",83),c(3),f(4,"translate"),s(),o(5,"p",84),c(6),f(7,"translate"),s()()()),i&2){let e=u(3);a(3),P(" ",b(4,3,"ORDER.TOTAL_QUANTITY_IN_CART"),": ",e.getTotalCartQuantity()," "),a(3),_(b(7,5,"ORDER.ADJUST_QUANTITIES_ABOVE"))}}function $r(i,t){if(i&1&&(o(0,"div",10)(1,"div",11)(2,"div",12)(3,"div",13),g(4,"app-image-uploader",14),s()()(),o(5,"div",15)(6,"div",16)(7,"h1",17),c(8),s(),o(9,"p",18),c(10),s(),o(11,"div",19)(12,"div",20)(13,"span",21),c(14),f(15,"translate"),s(),o(16,"span",22),c(17),f(18,"currency"),s()()(),o(19,"div",6)(20,"h3",23),c(21),f(22,"translate"),s(),v(23,Cr,3,2,"div",24)(24,Mr,2,1,"div",25)(25,Er,6,2,"div",26),s(),v(26,Fr,6,4,"div",27)(27,Vr,8,7,"div",28),s()()()),i&2){let e=u(2);a(4),l("initialImageUrl",e.imageUrlService.getImageUrl(e.product.imagePath,e.serverUrl))("readonly",!0),a(4),_(e.product.nameAr),a(2),_(e.product.description),a(4),x("",b(15,12,"ORDER.BASE_PRICE"),":"),a(3),_(b(18,14,e.product.sellingPrice)),a(4),_(b(22,16,"ORDER.SELECT_VARIANT_QUANTITY")),a(2),l("ngIf",e.productVariants.length===0),a(),l("ngIf",e.productVariants.length>0),a(),l("ngIf",e.allStores.length===0&&e.orderTypeId===2),a(),l("ngForOf",e.productModifiers),a(),l("ngIf",e.getTotalCartQuantity()>0)}}function Rr(i,t){if(i&1){let e=I();o(0,"div",4)(1,"div",5)(2,"div",6)(3,"button",7),y("click",function(){C(e);let n=u();return S(n.goBack())}),g(4,"i",8),c(5),f(6,"translate"),s()(),v(7,$r,28,18,"div",9),s()()}if(i&2){let e=u();a(5),x(" ",b(6,2,"ORDER.BACK_TO_PRODUCTS")," "),a(2),l("ngIf",e.product)}}function Nr(i,t){i&1&&(o(0,"div",85)(1,"div",86),g(2,"div",87),o(3,"h5",88),c(4,"\u062C\u0627\u0631\u064A \u062A\u062D\u0645\u064A\u0644 \u0627\u0644\u0645\u0646\u062A\u062C..."),s()()())}function Br(i,t){if(i&1){let e=I();o(0,"div",89)(1,"button",90),y("click",function(){C(e);let n=u();return S(n.openSplitQuantityDialog())}),g(2,"i",91),c(3," \u0642\u0633\u0651\u0645 \u0627\u0644\u0643\u0645\u064A\u0629 \u0627\u0644\u0639\u0627\u0645\u0629 \u0639\u0644\u0649 \u0627\u0644\u0645\u062A\u063A\u064A\u0631\u0627\u062A "),s()()}}var Ce=class i{constructor(t,e,r,n,d,m,h,J,X,Ie,Pe,qr){this.route=t;this.router=e;this.productsService=r;this.storeService=n;this.productVariantService=d;this.productModifierService=m;this.cartService=h;this.orderBreadcrumbService=J;this.authService=X;this.fb=Ie;this.imageUrlService=Pe;this.dialog=qr;this.productForm=this.fb.group({storeId:[null,q.required],variantId:[null],quantity:[1,[q.required,q.min(1)]]})}product=null;productId;orderTypeId;serverUrl=A.resourcesUrl;categoryId;subCategoryId;allStores=[];selectedStoreId=null;productVariants=[];productModifiers=[];selectedVariantId=null;selectedModifiers={};productForm;quantity=1;isLoading=!0;isAddingToCart=!1;ngOnInit(){this.route.parent?.paramMap.subscribe(t=>{let e=t.get("orderTypeId"),r=e?Number(e):1,n=this.orderTypeId!==r;this.orderTypeId=r,console.log("ProductDetailComponent - orderTypeId from PARENT route:",this.orderTypeId,"type:",typeof this.orderTypeId);let d=t.get("categoryId"),m=t.get("subCategoryId");this.categoryId=d?Number(d):this.categoryId,this.subCategoryId=m?Number(m):this.subCategoryId,this.product&&n&&(console.log("OrderTypeId changed, reloading stores..."),this.loadStores())}),this.route.queryParamMap.subscribe(t=>{let e=t.get("categoryId"),r=t.get("subCategoryId");e&&(this.categoryId=Number(e)),r&&(this.subCategoryId=Number(r))}),this.route.paramMap.subscribe(t=>{this.productId=Number(t.get("productId")),console.log("ProductDetailComponent - productId:",this.productId),this.productId&&(this.loadProduct(),this.loadProductVariants(),this.loadProductModifiers())})}loadProduct(){this.isLoading=!0,this.productsService.GetProductById(this.productId).subscribe({next:t=>{if(this.product=t,console.log("Loaded product:",t),console.log("Product inventories:",t.inventories),console.log("Current orderTypeId when loading product:",this.orderTypeId),!this.categoryId&&t.subCategory?.categoryId&&(this.categoryId=t.subCategory.categoryId),!this.subCategoryId&&t.subCategoryId&&(this.subCategoryId=t.subCategoryId),t.inventories&&t.inventories.forEach((e,r)=>{console.log(`Inventory ${r}:`,{id:e.id,productId:e.productId,storeId:e.storeId,variantId:e.variantId,quantity:e.quantity})}),this.loadVariantStockData(),!this.orderTypeId){console.warn("\u26A0\uFE0F orderTypeId not set yet, waiting...");let e=this.route.parent?.snapshot?.paramMap;e?.get("orderTypeId")&&(this.orderTypeId=Number(e.get("orderTypeId")),console.log("Set orderTypeId from snapshot:",this.orderTypeId))}this.loadStores(),this.setProductDetailBreadcrumbs(),this.isLoading=!1},error:t=>{console.error("Error loading product:",t),this.isLoading=!1}})}loadStores(){console.log("Loading stores..."),console.log("Order Type ID:",this.orderTypeId),console.log("Product available:",!!this.product),console.log("Product inventories:",this.product?.inventories),console.log("Product variants count:",this.productVariants.length),this.storeService.GetActiveStores().subscribe({next:t=>{console.log("Raw stores loaded:",t);let e=Number(this.orderTypeId);if(console.log("Comparing orderType:",e,"=== 1?",e===1),e===1)console.log("PURCHASE MODE: Showing all stores"),this.allStores=t;else if(this.productVariants.length===0){console.log("SALE MODE (no variants): Filtering stores with general inventory > 0");let r=this.filterStoresWithProductInventory(t);this.allStores=r,console.log(`Filtered ${t.length} stores down to ${r.length} stores with general stock`)}else console.log("SALE MODE (with variants): Showing all stores (getStoresForVariant will filter per variant)"),this.allStores=t;console.log("Final allStores:",this.allStores.length,"stores")},error:t=>{console.error("Error loading stores:",t)}})}filterStoresWithProductInventory(t){if(console.log("Filtering stores for product:",this.product),console.log("Product inventories:",this.product?.inventories),console.log("Order Type ID:",this.orderTypeId),!this.product||!this.product.inventories||this.product.inventories.length===0)return console.log("No product or no inventories found"),[];if(this.selectedVariantId)return console.log("Filtering by variant:",this.selectedVariantId),this.filterStoresWithVariantInventory(t);let e=this.product.inventories.filter(n=>{let d=!n.variantId||n.variantId===0,m=Number(n.quantity)||0,h=m>0;return console.log(`Store ${n.storeId}: isGeneral=${d}, quantity=${m}, hasStock=${h}`),d&&h}).map(n=>n.storeId);console.log("Valid store IDs (with stock > 0):",e),console.log("All stores:",t);let r=t.filter(n=>e.includes(n.id));return console.log("Filtered stores:",r),r}filterStoresWithVariantInventory(t){if(!this.product||!this.selectedVariantId)return[];let e=[],r=this.product.variants?.find(n=>n.id===this.selectedVariantId);if(r?.inventories&&r.inventories.length>0&&(e=r.inventories.filter(n=>(Number(n.quantity)||0)>0).map(n=>n.storeId)),this.product.inventories&&this.product.inventories.length>0){let n=this.product.inventories.filter(d=>{let m=d.variantId===this.selectedVariantId,h=Number(d.quantity)||0;return m&&h>0}).map(d=>d.storeId);e=[...new Set([...e,...n])]}return console.log("Valid store IDs for variant (with stock > 0):",e),t.filter(n=>e.includes(n.id))}loadProductVariants(){this.productVariantService.getProductVariantsByProductId(this.productId).subscribe({next:t=>{this.productVariants=t,console.log("\u2705 Loaded product variants:",t);let e=t.find(r=>r.isDefault);e&&(this.selectedVariantId=e.id,this.productForm.patchValue({variantId:e.id})),this.product&&(console.log("\u{1F504} Reloading variant stock data after variants loaded..."),this.loadVariantStockData(),this.orderTypeId===2&&(console.log("\u{1F504} Reloading stores after variants loaded (for sale orders with variants)..."),this.loadStores()))},error:t=>{console.error("Error loading variants:",t)}})}loadProductModifiers(){this.productModifierService.getProductModifiersByProductId(this.productId).subscribe({next:t=>{this.productModifiers=t,t.forEach(e=>{this.selectedModifiers[e.modifierId]=[]})},error:t=>{console.error("Error loading modifiers:",t)}})}onStoreChange(t){this.selectedStoreId=t,this.productForm.patchValue({storeId:t})}onVariantChange(t){this.selectedVariantId=t,this.productForm.patchValue({variantId:t}),this.refreshStoreList()}refreshStoreList(){this.storeService.GetActiveStores().subscribe({next:t=>{this.orderTypeId===1?this.allStores=t:this.allStores=this.filterStoresWithProductInventory(t),this.orderTypeId===2&&this.selectedStoreId&&!this.allStores.find(e=>e.id===this.selectedStoreId)&&(this.selectedStoreId=null,this.productForm.patchValue({storeId:null}))},error:t=>{console.error("Error refreshing stores:",t)}})}onModifierChange(t,e,r){if(this.selectedModifiers[t]||(this.selectedModifiers[t]=[]),r)this.selectedModifiers[t].push(e);else{let n=this.selectedModifiers[t].indexOf(e);n>-1&&this.selectedModifiers[t].splice(n,1)}}isModifierOptionSelected(t,e){return this.selectedModifiers[t]?.includes(e)||!1}onQuantityChange(t){t<1?this.quantity=1:this.quantity=t,this.productForm.patchValue({quantity:this.quantity})}addToCart(){return De(this,null,function*(){if(!this.product||!this.selectedStoreId){alert("\u064A\u0631\u062C\u0649 \u0627\u062E\u062A\u064A\u0627\u0631 \u0627\u0644\u0645\u0633\u062A\u0648\u062F\u0639 \u0623\u0648\u0644\u0627\u064B");return}if(this.cartService.hasActiveOrder(this.orderTypeId)){let t=this.orderTypeId===1?"\u064A\u0631\u062C\u0649 \u0625\u0646\u0647\u0627\u0621 \u0637\u0644\u0628 \u0627\u0644\u0634\u0631\u0627\u0621 \u0623\u0648\u0644\u0627\u064B":"\u064A\u0631\u062C\u0649 \u0625\u0646\u0647\u0627\u0621 \u0637\u0644\u0628 \u0627\u0644\u0628\u064A\u0639 \u0623\u0648\u0644\u0627\u064B";alert(t);return}for(let t of this.productModifiers)if(t.isRequired&&(!this.selectedModifiers[t.modifierId]||this.selectedModifiers[t.modifierId].length===0)){alert(`\u064A\u0631\u062C\u0649 \u0627\u062E\u062A\u064A\u0627\u0631 ${t.modifierName||t.modifier?.name}`);return}this.isAddingToCart=!0;try{if(!(yield this.cartService.validateStockForCartItem(this.product.id,this.selectedStoreId,this.quantity)))return;this.cartService.addToCart(this.product,this.quantity,this.selectedStoreId,this.selectedVariantId||void 0,this.selectedModifiers),alert("\u062A\u0645 \u0625\u0636\u0627\u0641\u0629 \u0627\u0644\u0645\u0646\u062A\u062C \u0625\u0644\u0649 \u0627\u0644\u0633\u0644\u0629 \u0628\u0646\u062C\u0627\u062D"),this.router.navigate(["/order",this.orderTypeId,"categories",this.product.subCategory?.categoryId,"sub-categories",this.product.subCategoryId,"products"])}catch(t){console.error("Error adding to cart:",t),alert("\u062D\u062F\u062B \u062E\u0637\u0623 \u0623\u062B\u0646\u0627\u0621 \u0625\u0636\u0627\u0641\u0629 \u0627\u0644\u0645\u0646\u062A\u062C \u0625\u0644\u0649 \u0627\u0644\u0633\u0644\u0629")}finally{this.isAddingToCart=!1}})}setProductDetailBreadcrumbs(){if(!this.product)return;let t=this.categoryId??this.product.subCategory?.categoryId??void 0,e=this.subCategoryId??this.product.subCategoryId??void 0;if(!t||!e)return;let r=this.product.subCategory?.category?.nameAr||"\u0627\u0644\u062A\u0635\u0646\u064A\u0641",n=this.product.subCategory?.nameAr||"\u0627\u0644\u062A\u0635\u0646\u064A\u0641 \u0627\u0644\u0641\u0631\u0639\u064A",d=this.product.nameAr||"\u0627\u0644\u0645\u0646\u062A\u062C";this.orderBreadcrumbService.setProductDetailBreadcrumbs(this.orderTypeId,t,r,e,n,d)}goBack(){this.product?.subCategory?.categoryId&&this.product?.subCategoryId?this.router.navigate(["/order",this.orderTypeId,"categories",this.product.subCategory.categoryId,"sub-categories",this.product.subCategoryId,"products"]):this.categoryId&&this.subCategoryId?this.router.navigate(["/order",this.orderTypeId,"categories",this.categoryId,"sub-categories",this.subCategoryId,"products"]):this.router.navigate(["/order",this.orderTypeId,"categories"])}goToProductForm(){this.product?.id?this.router.navigate(["/admin/product-form"],{queryParams:{productId:this.product.id}}):console.error("Product ID not available")}getProductPrice(){if(!this.product)return 0;let t=this.product.sellingPrice;if(this.selectedVariantId){let e=this.productVariants.find(r=>r.id===this.selectedVariantId);e?.priceAdjustment&&(t+=e.priceAdjustment)}for(let e in this.selectedModifiers){let r=this.productModifiers.find(n=>n.modifierId===Number(e));if(r?.modifier?.options)for(let n of this.selectedModifiers[e]){let d=r.modifier.options.find(m=>m.id===n);d?.priceAdjustment&&(t+=d.priceAdjustment)}}return t}getStoreQuantity(t){return this.product?.inventories&&this.product.inventories.find(r=>r.storeId===t)?.quantity||0}variantStockData={};loadVariantStockData(){if(console.log("\u{1F504} Loading variant stock data..."),console.log("\u{1F4E6} Product:",this.product),console.log("\u{1F3F7}\uFE0F Product variants:",this.product?.variants),console.log("\u{1F4CA} Product variantStockData:",this.product?.variantStockData),console.log("\u{1F4CB} Product inventories:",this.product?.inventories),this.variantStockData={},this.product?.variantStockData){console.log("\u{1F4E6} Processing variantStockData from API...");let t=this.product.variantStockData;Object.keys(t).forEach(e=>{let r=t[e];if(console.log(`\u{1F3EA} Store ${e} stock data:`,r),r&&Array.isArray(r)){let n=e.replace("store_","");r.forEach(d=>{let m=`${this.product.id}-${d.variantId}-${n}`;this.variantStockData[m]=d.availableQuantity||0,console.log(`\u2705 Set variant stock: ${m} = ${this.variantStockData[m]}`)})}})}this.product?.inventories&&this.product.inventories.length>0?(console.log("\u{1F4CB} Processing inventories for variant stock..."),this.product.inventories.forEach(t=>{console.log("\u{1F50D} Processing inventory:",{id:t.id,productId:t.productId,storeId:t.storeId,variantId:t.variantId,quantity:t.quantity});let e=t.variantId!=null?Number(t.variantId):null;if(e!=null&&e!==0){let r=`${this.product.id}-${e}-${t.storeId}`,n=Number(t.quantity)||0,d=this.productVariants.length===0||this.productVariants.some(m=>Number(m.id)===e);n>0?!this.variantStockData[r]||this.variantStockData[r]<n?(this.variantStockData[r]=n,d||this.productVariants.length===0?console.log(`\u2705 Set variant stock from inventory: ${r} = ${n}`):console.log(`\u26A0\uFE0F Set variant stock for variant ${e} that's not yet loaded: ${r} = ${n}`)):console.log(`\u2139\uFE0F Key ${r} already exists with value ${this.variantStockData[r]}, keeping it`):console.log(`\u23ED\uFE0F Variant ${e} has quantity 0, skipping`)}else console.log("\u23ED\uFE0F Inventory record has no variant ID, skipping (this is general product inventory)")})):console.log("\u26A0\uFE0F No inventories found in product"),console.log("\u2705 Final variant stock data:",this.variantStockData),console.log("\u{1F4CA} Total variant stock entries:",Object.keys(this.variantStockData).length)}getVariantStock(t,e,r){return this.variantStockData[`${t}-${e}-${r}`]||0}getStoresForVariant(t){if(console.log("\u{1F50D} Getting stores for variant:",t),console.log("\u{1F4E6} Order Type ID:",this.orderTypeId),console.log("\u{1F4CA} All stores count:",this.allStores.length),console.log("\u{1F4BE} Variant stock data:",this.variantStockData),this.orderTypeId===1)return this.allStores;{let e=this.allStores.filter(r=>{let n=this.getVariantStock(this.product.id,t,r.id);if(console.log(`\u{1F3EA} Checking variant ${t} in store ${r.id} (${r.name}): stock = ${n}`),n===0&&this.product?.inventories){let d=this.product.inventories.find(m=>{let h=m.variantId!=null?Number(m.variantId):null,J=Number(m.quantity)||0,X=h===t,Ie=m.storeId===r.id,Pe=J>0;return X&&Ie&&Pe&&console.log(`\u{1F50D} Found matching inventory: variantId=${h}, storeId=${r.id}, quantity=${J}`),X&&Ie&&Pe});if(d){let m=Number(d.quantity)||0;console.log(`\u2705 Found direct inventory: ${m} for variant ${t} in store ${r.id}`);let h=`${this.product.id}-${t}-${r.id}`;return this.variantStockData[h]=m,!0}}return n>0});return console.log(`\u2705 Filtered stores for variant ${t} (sale order):`,e.length,"stores"),e}}getVariantStockForStore(t,e){return this.getVariantStock(this.product.id,t,e)}getCartQuantityForProductStore(t,e){try{let r=this.cartService.getCartItemQuantity(t,e);return console.log(`Cart quantity for product ${t}, store ${e}:`,r),r}catch(r){return console.error("Error getting cart quantity:",r),0}}increaseQuantity(t,e){if(console.log("Increase quantity called for product:",t,"store:",e),!this.product){console.log("No product available");return}let r=this.getCartQuantityForProductStore(t,e),n=this.getStoreQuantity(e);console.log("Current quantity:",r,"Available stock:",n),this.orderTypeId===1||r<n?(console.log("Adding to cart..."),this.cartService.addToCart(this.product,1,e,void 0)):console.log("Cannot add more - stock limit reached")}decreaseQuantity(t,e){if(console.log("Decrease quantity called for product:",t,"store:",e),!this.product){console.log("No product available");return}let r=this.getCartQuantityForProductStore(t,e);console.log("Current quantity:",r),r>0?(console.log("Removing from cart..."),this.cartService.removeFromCartWithDetails(t,e,1)):console.log("Cannot decrease - quantity is already 0")}getCartQuantityForVariantStore(t,e){let r=this.cartService.getCartItemQuantity(this.product.id,e,t);return console.log(`Cart quantity for variant ${t}, store ${e}:`,r),r}increaseVariantQuantity(t,e){if(console.log("Increase variant quantity called for variant:",t,"store:",e),!this.product){console.log("No product available");return}let r=this.getCartQuantityForVariantStore(t,e),n=this.getVariantStockForStore(t,e);console.log("Current quantity:",r,"Available stock:",n),this.orderTypeId===1||r<n?(console.log("Adding variant to cart..."),this.cartService.addToCart(this.product,1,e,t)):console.log("Cannot add more - stock limit reached")}decreaseVariantQuantity(t,e){if(console.log("Decrease variant quantity called for variant:",t,"store:",e),!this.product){console.log("No product available");return}let r=this.getCartQuantityForVariantStore(t,e);console.log("Current quantity:",r),r>0?(console.log("Removing variant from cart..."),this.cartService.removeFromCartWithDetails(this.product.id,e,1,t)):console.log("Cannot decrease - quantity is already 0")}getTotalCartQuantity(){if(!this.product)return 0;let t=0;return this.productVariants.length===0?this.allStores.forEach(e=>{t+=this.getCartQuantityForProductStore(this.product.id,e.id)}):this.productVariants.forEach(e=>{this.getStoresForVariant(e.id).forEach(r=>{t+=this.getCartQuantityForVariantStore(e.id,r.id)})}),t}setProductQuantity(t,e,r){let n=parseInt(r.target.value)||0,d=this.getStoreQuantity(e);if(console.log("Setting product quantity:",t,e,n,"max:",d),n<0){r.target.value=0;return}this.orderTypeId===2&&n>d&&(r.target.value=d,n=d);let m=this.getCartQuantityForProductStore(t,e);if(n===0)m>0&&this.cartService.removeFromCartWithDetails(t,e,m);else if(n>m){let h=n-m;this.cartService.addToCart(this.product,h,e,void 0)}else if(n<m){let h=m-n;this.cartService.removeFromCartWithDetails(t,e,h)}}setVariantQuantity(t,e,r){let n=parseInt(r.target.value)||0,d=this.getVariantStockForStore(t,e);if(console.log("Setting variant quantity:",t,e,n,"max:",d),n<0){r.target.value=0;return}this.orderTypeId===2&&n>d&&(r.target.value=d,n=d);let m=this.getCartQuantityForVariantStore(t,e);if(n===0)m>0&&this.cartService.removeFromCartWithDetails(this.product.id,e,m,t);else if(n>m){let h=n-m;this.cartService.addToCart(this.product,h,e,t)}else if(n<m){let h=m-n;this.cartService.removeFromCartWithDetails(this.product.id,e,h,t)}}hasGeneralStock(){return this.product?.inventories?.some(t=>!t.variantId&&t.quantity>0)??!1}openSplitQuantityDialog(){if(!this.product||!this.productVariants.length)return;let t=this.product.inventories.find(e=>!e.variantId&&e.quantity>0);t&&this.dialog.open(xe,{width:"450px",maxWidth:"95vw",data:{product:this.product,variants:this.productVariants,generalInventory:t},disableClose:!1}).afterClosed().subscribe(e=>{e&&this.loadProduct()})}static \u0275fac=function(e){return new(e||i)(p(T),p(k),p(Y),p(ut),p(_e),p(ye),p(K),p(j),p(w),p(H),p(N),p(lt))};static \u0275cmp=O({type:i,selectors:[["app-product-detail"]],standalone:!1,decls:3,vars:3,consts:[["noProductStock",""],["class","min-h-screen bg-gray-50 py-8","dir","rtl",4,"ngIf"],["class","min-h-screen bg-gray-50 flex items-center justify-center",4,"ngIf"],["class","mb-4 flex justify-end",4,"ngIf"],["dir","rtl",1,"min-h-screen","bg-gray-50","py-8"],[1,"max-w-7xl","mx-auto","px-4","sm:px-6","lg:px-8"],[1,"mb-6"],[1,"inline-flex","items-center","px-4","py-2","border","border-gray-300","rounded-lg","text-gray-700","bg-white","hover:bg-gray-50","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:ring-offset-2","transition-colors",3,"click"],[1,"bi","bi-arrow-right","mr-2"],["class","grid grid-cols-1 lg:grid-cols-2 gap-8",4,"ngIf"],[1,"grid","grid-cols-1","lg:grid-cols-2","gap-8"],[1,"space-y-4"],[1,"bg-white","rounded-2xl","shadow-lg","overflow-hidden"],[1,"aspect-square","bg-gradient-to-br","from-gray-50","to-gray-100","flex","items-center","justify-center","p-8"],[3,"initialImageUrl","readonly"],[1,"space-y-6"],[1,"bg-white","rounded-2xl","shadow-lg","p-6"],[1,"text-3xl","font-bold","text-gray-900","mb-4"],[1,"text-gray-600","text-lg","leading-relaxed","mb-6"],[1,"bg-gradient-to-r","from-green-50","to-emerald-50","rounded-xl","p-4","mb-6"],[1,"flex","justify-between","items-center"],[1,"text-lg","font-semibold","text-gray-700"],[1,"text-3xl","font-bold","text-green-600"],[1,"text-lg","font-semibold","text-gray-900","mb-4"],[4,"ngIf"],["class","space-y-6",4,"ngIf"],["class","bg-yellow-50 border border-yellow-200 rounded-xl p-4",4,"ngIf"],["class","mb-6",4,"ngFor","ngForOf"],["class","mb-6",4,"ngIf"],["class","bg-yellow-50 border-2 border-yellow-400 rounded-xl p-6 mb-4",4,"ngIf"],["class","space-y-4",4,"ngIf"],[1,"bg-yellow-50","border-2","border-yellow-400","rounded-xl","p-6","mb-4"],[1,"flex","items-start"],[1,"flex-shrink-0"],[1,"bi","bi-exclamation-triangle","text-yellow-600","text-3xl"],[1,"mr-4","flex-1"],[1,"text-lg","font-bold","text-yellow-900","mb-2"],[1,"text-yellow-800","mb-4"],["type","button",1,"px-6","py-3","bg-yellow-600","text-white","font-semibold","rounded-lg","hover:bg-yellow-700","transition-colors","shadow-md",3,"click"],[1,"bi","bi-plus-circle","mr-2"],["class","bg-gray-50 rounded-xl p-4 border border-gray-200",4,"ngFor","ngForOf"],[1,"bg-gray-50","rounded-xl","p-4","border","border-gray-200"],[1,"flex","items-center"],[1,"bi","bi-building","text-blue-600","mr-3","text-lg"],[1,"font-semibold","text-gray-900"],[1,"text-gray-500","text-sm"],[1,"mr-3","text-gray-600","text-sm"],[1,"flex","items-center","bg-white","rounded-lg","border","border-gray-300"],[1,"px-3","py-2","text-red-600","hover:bg-red-50","rounded-r-lg","transition-colors",3,"click","disabled"],[1,"bi","bi-dash"],["type","number","min","0",1,"w-16","px-2","py-2","text-center","border-0","focus:outline-none","focus:ring-0",3,"change","value","max"],[1,"px-3","py-2","text-green-600","hover:bg-green-50","rounded-l-lg","transition-colors",3,"click","disabled"],[1,"bi","bi-plus"],[1,"mt-3","pt-3","border-t","border-gray-200"],[1,"text-sm","text-gray-600"],[1,"font-semibold","text-green-600"],["class","bg-blue-50 rounded-xl p-4 border border-blue-200",4,"ngFor","ngForOf"],[1,"bg-blue-50","rounded-xl","p-4","border","border-blue-200"],[1,"mb-4"],[1,"text-lg","font-semibold","text-blue-900","mb-2"],[1,"bi","bi-tag","mr-2"],["class","text-green-600 text-sm",4,"ngIf"],[1,"space-y-3"],["class","bg-white rounded-lg p-4 border border-gray-200",4,"ngFor","ngForOf"],["class","bg-yellow-50 border border-yellow-200 rounded-lg p-3",4,"ngIf"],[1,"text-green-600","text-sm"],[1,"bg-white","rounded-lg","p-4","border","border-gray-200"],[1,"bg-yellow-50","border","border-yellow-200","rounded-lg","p-3"],[1,"bi","bi-exclamation-triangle","text-yellow-600","mr-2"],[1,"text-sm","text-yellow-800"],[1,"bg-yellow-50","border","border-yellow-200","rounded-xl","p-4"],["class","text-yellow-800",4,"ngIf","ngIfElse"],[1,"text-yellow-800"],[1,"block","text-lg","font-semibold","text-gray-900","mb-3"],["class","text-red-500",4,"ngIf"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-3"],["class","flex items-center",4,"ngFor","ngForOf"],[1,"text-red-500"],["type","checkbox",1,"h-4","w-4","text-blue-600","focus:ring-blue-500","border-gray-300","rounded",3,"change","id","checked"],[1,"mr-3","text-sm","text-gray-700",3,"for"],["class","text-green-600 font-semibold",4,"ngIf"],[1,"text-green-600","font-semibold"],[1,"bg-gradient-to-r","from-blue-50","to-indigo-50","rounded-xl","p-6","text-center","border","border-blue-200"],[1,"text-2xl","font-bold","text-blue-900","mb-2"],[1,"text-blue-700"],[1,"min-h-screen","bg-gray-50","flex","items-center","justify-center"],[1,"bg-white","rounded-2xl","shadow-lg","p-8","text-center"],[1,"w-12","h-12","border-4","border-blue-600","border-t-transparent","rounded-full","animate-spin","mx-auto","mb-4"],[1,"text-lg","font-semibold","text-gray-900"],[1,"mb-4","flex","justify-end"],["type","button",1,"bg-green-600","hover:bg-green-700","text-white","px-4","py-2","rounded-lg","font-semibold","shadow",3,"click"],[1,"bi","bi-arrow-down-up","mr-2"]],template:function(e,r){e&1&&v(0,Rr,8,4,"div",1)(1,Nr,5,0,"div",2)(2,Br,4,0,"div",3),e&2&&(l("ngIf",!r.isLoading),a(),l("ngIf",r.isLoading),a(),l("ngIf",r.authService.isAdmin&&r.hasGeneralStock()&&r.productVariants.length>0))},dependencies:[E,M,pe,R,se,me],styles:[".card[_ngcontent-%COMP%]{border-radius:15px;transition:transform .3s ease,box-shadow .3s ease}.card[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 8px 25px #0000001a!important}.btn[_ngcontent-%COMP%]{border-radius:10px;font-weight:500;transition:all .3s ease}.btn[_ngcontent-%COMP%]:hover{transform:translateY(-1px)}.form-check-input[_ngcontent-%COMP%]{border-radius:6px}.form-select[_ngcontent-%COMP%]{border-radius:10px;border:2px solid #e9ecef;transition:border-color .3s ease}.form-select[_ngcontent-%COMP%]:focus{border-color:#0d6efd;box-shadow:0 0 0 .2rem #0d6efd40}.spinner-border[_ngcontent-%COMP%]{width:2rem;height:2rem}.card-title[_ngcontent-%COMP%]{font-weight:700;line-height:1.3}.card-text[_ngcontent-%COMP%]{line-height:1.6}.form-label[_ngcontent-%COMP%]{font-weight:600;margin-bottom:.75rem}.btn-lg[_ngcontent-%COMP%]{padding:.75rem 1.5rem;font-size:1.1rem;font-weight:600}.compact-stock-list[_ngcontent-%COMP%]{max-height:200px;overflow-y:auto}.compact-stock-list[_ngcontent-%COMP%]   .stock-item[_ngcontent-%COMP%]{transition:all .2s ease;border:1px solid rgba(0,0,0,.05);background-color:#f8f9fa80;margin-bottom:.5rem;padding:.75rem}.compact-stock-list[_ngcontent-%COMP%]   .stock-item[_ngcontent-%COMP%]:hover{background-color:#0d6efd0d!important;border-color:#0d6efd33;transform:translate(1px)}.compact-stock-list[_ngcontent-%COMP%]   .stock-item[_ngcontent-%COMP%]:last-child{margin-bottom:0}.compact-stock-list[_ngcontent-%COMP%]   .stock-item[_ngcontent-%COMP%]   .badge[_ngcontent-%COMP%]{font-size:.7rem;padding:.3em .5em}.variants-for-store[_ngcontent-%COMP%]{margin-top:.5rem;padding-top:.5rem;border-top:1px solid rgba(0,0,0,.1)}.variants-for-store[_ngcontent-%COMP%]   .variants-list[_ngcontent-%COMP%]{max-height:100px;overflow-y:auto}.variants-for-store[_ngcontent-%COMP%]   .variants-list[_ngcontent-%COMP%]   .variant-item[_ngcontent-%COMP%]{transition:all .2s ease;border:1px solid rgba(0,0,0,.05);background-color:#f8f9fa4d;margin-bottom:.25rem;padding:.4rem}.variants-for-store[_ngcontent-%COMP%]   .variants-list[_ngcontent-%COMP%]   .variant-item[_ngcontent-%COMP%]:hover{background-color:#0dcaf00d!important;border-color:#0dcaf033;transform:translate(1px)}.variants-for-store[_ngcontent-%COMP%]   .variants-list[_ngcontent-%COMP%]   .variant-item[_ngcontent-%COMP%]:last-child{margin-bottom:0}.variants-for-store[_ngcontent-%COMP%]   .variants-list[_ngcontent-%COMP%]   .variant-item[_ngcontent-%COMP%]   .badge[_ngcontent-%COMP%]{font-size:.65rem;padding:.25em .4em}.variant-store-cards[_ngcontent-%COMP%]   .variant-section[_ngcontent-%COMP%]{border-left:3px solid #0d6efd;padding-left:1rem;margin-bottom:1.5rem}.variant-store-cards[_ngcontent-%COMP%]   .variant-section[_ngcontent-%COMP%]   .variant-header[_ngcontent-%COMP%]{background:linear-gradient(135deg,#0d6efd1a,#0dcaf01a);padding:.75rem 1rem;border-radius:8px;margin-bottom:1rem;border:1px solid rgba(13,110,253,.2)}.variant-store-cards[_ngcontent-%COMP%]   .variant-store-card[_ngcontent-%COMP%]{transition:all .3s ease}.variant-store-cards[_ngcontent-%COMP%]   .variant-store-card[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]{border:1px solid rgba(0,0,0,.08);transition:all .3s ease}.variant-store-cards[_ngcontent-%COMP%]   .variant-store-card[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]:hover{border-color:#0d6efd4d;box-shadow:0 4px 12px #0d6efd1a;transform:translateY(-1px)}.variant-store-cards[_ngcontent-%COMP%]   .variant-store-card[_ngcontent-%COMP%]   .quantity-controls[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem}.variant-store-cards[_ngcontent-%COMP%]   .variant-store-card[_ngcontent-%COMP%]   .quantity-controls[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{width:32px;height:32px;padding:0;display:flex;align-items:center;justify-content:center;border-radius:6px;font-size:.9rem;font-weight:600;transition:all .2s ease}.variant-store-cards[_ngcontent-%COMP%]   .variant-store-card[_ngcontent-%COMP%]   .quantity-controls[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]:hover:not(:disabled){transform:scale(1.1)}.variant-store-cards[_ngcontent-%COMP%]   .variant-store-card[_ngcontent-%COMP%]   .quantity-controls[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}.variant-store-cards[_ngcontent-%COMP%]   .variant-store-card[_ngcontent-%COMP%]   .quantity-controls[_ngcontent-%COMP%]   .btn-outline-danger[_ngcontent-%COMP%]{border-color:#dc3545;color:#dc3545}.variant-store-cards[_ngcontent-%COMP%]   .variant-store-card[_ngcontent-%COMP%]   .quantity-controls[_ngcontent-%COMP%]   .btn-outline-danger[_ngcontent-%COMP%]:hover:not(:disabled){background-color:#dc3545;color:#fff}.variant-store-cards[_ngcontent-%COMP%]   .variant-store-card[_ngcontent-%COMP%]   .quantity-controls[_ngcontent-%COMP%]   .btn-outline-success[_ngcontent-%COMP%]{border-color:#198754;color:#198754}.variant-store-cards[_ngcontent-%COMP%]   .variant-store-card[_ngcontent-%COMP%]   .quantity-controls[_ngcontent-%COMP%]   .btn-outline-success[_ngcontent-%COMP%]:hover:not(:disabled){background-color:#198754;color:#fff}.card.bg-light[_ngcontent-%COMP%]{background:linear-gradient(135deg,#0d6efd0d,#0dcaf00d)!important;border:1px solid rgba(13,110,253,.2)}.card.bg-light[_ngcontent-%COMP%]   .text-primary[_ngcontent-%COMP%]{font-weight:700}@media (max-width: 768px){.container[_ngcontent-%COMP%]{padding-left:1rem;padding-right:1rem}.card-body[_ngcontent-%COMP%]{padding:1.5rem!important}.btn-lg[_ngcontent-%COMP%]{padding:.6rem 1.2rem;font-size:1rem}.variant-store-cards[_ngcontent-%COMP%]   .variant-store-card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]{padding:1rem!important}.variant-store-cards[_ngcontent-%COMP%]   .variant-store-card[_ngcontent-%COMP%]   .quantity-controls[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{width:28px;height:28px;font-size:.8rem}}"]})};var jr=[{path:":orderTypeId",component:ge,canActivate:[mt],children:[{path:"categories",component:fe},{path:"categories/:categoryId/sub-categories",component:be,resolve:{categoriesResolver:yt}},{path:"categories/:categoryId/sub-categories/:subCategoryId/products",component:he,resolve:{subCategoriesResolver:gt}},{path:"product/:productId",component:Ce},{path:"",redirectTo:"categories",pathMatch:"full"}]}],Se=class i{static \u0275fac=function(e){return new(e||i)};static \u0275mod=oe({type:i});static \u0275inj=ie({imports:[Me.forChild(jr),Me]})};var Mt=class i{static \u0275fac=function(e){return new(e||i)};static \u0275mod=oe({type:i});static \u0275inj=ie({imports:[de,Se,vt,st]})};export{Mt as OrderModule};
