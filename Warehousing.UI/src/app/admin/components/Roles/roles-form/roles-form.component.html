<div class="dialog-container p-3 p-md-4">
    <h5 class="mb-4 text-center">إضافة / تعديل صلاحية</h5>

    <form [formGroup]="roleForm">
        <!-- Code -->
        <div class="floating-label-input mb-3">
            <input type="text" id="code" class="form-control" formControlName="code" placeholder=" " />
            <label for="code">الكود</label>
        </div>

        <!-- Name (EN) -->
        <div class="floating-label-input mb-3">
            <input type="text" id="nameEn" class="form-control" formControlName="nameEn" placeholder=" " />
            <label for="nameEn">الاسم بالانجليزي</label>
        </div>

        <!-- Name (AR) -->
        <div class="floating-label-input mb-3">
            <input type="text" id="nameAr" class="form-control" formControlName="nameAr" placeholder=" " />
            <label for="nameAr">الاسم بالعربي</label>
        </div>

        <!-- Permissions (Checkboxes) -->
        <div class="mb-3">
            <label class="form-label fw-bold">الصلاحيات</label>
            <div class="row g-2">
                <div class="col-12 col-sm-6 col-md-4" *ngFor="let p of permissions">
                    <div class="form-check form-check-reverse">
                        <input class="form-check-input" type="checkbox" id="perm_{{ p.id }}" [value]="p.id"
                            [checked]="roleForm.get('rolePermissionIds')?.value.includes(p.id)"
                            (change)="onPermissionChange(p.id, $event)" />
                        <label class="form-check-label" [for]="'perm_' + p.id">
                            {{ lang.currentLang === 'ar' ? p.nameAr : p.nameEn }}
                        </label>
                    </div>
                </div>
            </div>
        </div>
        <hr>
        <!-- Categories -->
        <div class="mb-3">
            <label class="form-label fw-bold">التصنيفات</label>
            <div class="row g-2">
                <div class="col-12 col-sm-6 col-md-4" *ngFor="let c of categories">
                    <div class="form-check form-check-reverse">
                        <input class="form-check-input" type="checkbox" [id]="'cat_' + c.id" [value]="c.id"
                            [checked]="roleForm.get('categoryIds')?.value.includes(c.id)"
                            (change)="onCategoryChange(c.id, $event)" />
                        <label class="form-check-label" [for]="'cat_' + c.id">
                            {{ lang.currentLang === 'ar' ? c.nameAr : c.nameEn }}
                        </label>
                    </div>
                </div>
            </div>
        </div>
        <hr>
        <!-- Products -->
        <div class="mb-3">
            <label class="form-label fw-bold">المنتجات</label>
            <div class="row g-2">
                <div class="col-12 col-sm-6 col-md-4" *ngFor="let p of products">
                    <div class="form-check form-check-reverse">
                        <input class="form-check-input" type="checkbox" [id]="'prod_' + p.id" [value]="p.id"
                            [checked]="roleForm.get('productIds')?.value.includes(p.id)"
                            (change)="onProductChange(p.id, $event)" />
                        <label class="form-check-label" [for]="'prod_' + p.id">
                            {{ lang.currentLang === 'ar' ? p.nameAr : p.nameEn }}
                        </label>
                    </div>
                </div>
            </div>
        </div>

        <!-- Actions -->
        <div class="mt-4 d-flex gap-2 flex-wrap">
            <button type="submit" class="btn btn-primary flex-fill" [disabled]="roleForm.invalid" (click)="save()">
                حفظ
            </button>
            <button type="button" class="btn btn-secondary flex-fill" (click)="cancel()">
                إلغاء
            </button>
        </div>
    </form>
</div>