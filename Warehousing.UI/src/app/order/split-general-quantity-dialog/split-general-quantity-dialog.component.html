<h2 class="text-xl font-bold text-gray-800 mb-3 text-center">قسّم الكمية العامة على المتغيرات</h2>
<div class="mb-4 text-gray-600 leading-loose text-center">
  الكمية العامة الحالية: <span class="font-bold text-green-700">{{ generalQuantity }}</span>
</div>
<form [formGroup]="allocationForm" (ngSubmit)="submit()">
  <div class="space-y-4">
    <div *ngFor="let alloc of allocations().controls; let i = index" [formGroupName]="i" class="flex justify-between items-center bg-gray-50 px-3 py-2 rounded-lg">
      <div class="text-gray-800 font-semibold">{{ alloc.value.name }}</div>
      <input type="number" formControlName="quantity" min="0"
        class="w-24 px-2 py-1 border rounded text-center focus:outline-none" />
    </div>
  </div>
  <div class="text-right mt-4">
    مجموع التوزيع: <span [class.text-red-600]="totalAssigned !== generalQuantity">{{ totalAssigned }}</span> /
    <span class="font-bold">{{ generalQuantity }}</span>
    <span *ngIf="totalAssigned !== generalQuantity" class="text-red-500 ml-2">يجب أن يساوي المجموع الكمية العامة</span>
  </div>

  <div class="mt-6 flex gap-3 justify-end">
    <button type="button" (click)="close()" class="px-5 py-2 rounded bg-gray-200 text-gray-700 font-semibold hover:bg-gray-300">إلغاء</button>
    <button type="submit" [disabled]!="!isAllocationValid()" class="px-7 py-2 rounded bg-green-600 text-white font-semibold shadow hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed">
      توزيع الكمية
    </button>
  </div>
</form>

