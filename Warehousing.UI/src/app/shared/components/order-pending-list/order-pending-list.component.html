<div class="container mt-3">
  <div class="row g-3" *ngIf="(orders$ | async) as data">
    <div class="col-md-6 col-lg-4" *ngFor="let order of data.orders">
      <div class="card shadow-sm border-0 h-100">
        <!-- Card Header -->
        <div class="card-header d-flex justify-content-between align-items-center" 
             [ngStyle]="{'background-color': getStatusColor(order?.statusId! - 1)}">
          <span class="fw-bold text-white">
            {{ order.orderType?.nameAr }} رقم  – {{ order.id }}  
          </span>
          <i class="bi bi-box-seam text-white fs-5"></i>
        </div>

        <!-- Card Body -->
        <div class="card-body">
          <h6 class="card-title mb-1">
            <i class="bi bi-calendar-date me-1 text-muted ms-2"></i>
            {{ order.orderDate | date: 'yyyy-MM-dd' }}
          </h6>

          <p class="mb-1">
            <i class="bi bi-cash-coin me-1 text-muted ms-2"></i>
            <strong>{{ order.totalAmount | number:'1.2-2' }}</strong>
          </p>

          <!-- Items (first product preview) -->
          <div *ngIf="order.items?.length! > 0" class="mt-2 d-flex align-items-center">
            <div class="fw-semibold">عدد المواد في الطلب : {{ order.items?.length }}</div>
            <!-- <img [src]="resourcesUrl + order.items[0].product?.imagePath"
                 class="rounded me-2 ms-2"
                 style="width: 50px; height: 50px; object-fit: cover;"
                 alt="product image" />
            <div>
              <div class="fw-semibold">{{ order.items[0].product?.nameAr || order.items[0].product?.nameEn }}</div>
              <small class="text-muted">
                الكمية: {{ order.items[0].quantity }} × {{ order.items[0].product?.unit?.nameAr }}
              </small>
            </div> -->
          </div>
        </div>

        <!-- Card Footer -->
        <div class="card-footer d-flex justify-content-between align-items-center bg-light">
          <span class="badge text-white" 
                [ngStyle]="{'background-color': getStatusColor(order?.statusId! - 1)}">
            {{ order.status?.nameAr }}
          </span>

          <!-- Open in Cart button -->
          <button class="btn btn-sm btn-outline-primary" (click)="openInCart(order)">
            <i class="bi bi-cart-plus"></i> فتح
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Pagination -->
    <nav aria-label="Page navigation" class="mt-4 d-flex justify-content-center">
      <ul class="pagination">
        <li class="page-item" [class.disabled]="+PageIndex.value === 1">
          <button class="page-link btn" (click)="changePage(+PageIndex.value - 1)">«</button>
        </li>

        <!-- First page -->
        <li class="page-item" [class.active]="+PageIndex.value === 1">
          <button class="page-link btn" (click)="changePage(1)">1</button>
        </li>

        <!-- Left Ellipsis -->
        <li class="page-item disabled" *ngIf="+PageIndex.value > 4">
          <span class="page-link">...</span>
        </li>

        <!-- Dynamic middle pages -->
        <li class="page-item" *ngFor="let page of getPageRange()" [class.active]="page === +PageIndex.value">
          <button class="page-link btn" (click)="changePage(page)">{{ page }}</button>
        </li>

        <!-- Right Ellipsis -->
        <li class="page-item disabled" *ngIf="+PageIndex.value < totalPages - 3">
          <span class="page-link">...</span>
        </li>

        <!-- Last page -->
        <li class="page-item" [class.active]="+PageIndex.value === totalPages" *ngIf="totalPages > 1">
          <button class="page-link btn" (click)="changePage(totalPages)">{{ totalPages }}</button>
        </li>

        <li class="page-item" [class.disabled]="+PageIndex.value === totalPages || totalPages === 0">
          <button class="page-link btn" (click)="changePage(+PageIndex.value + 1)">»</button>
        </li>
      </ul>
    </nav>
</div>
